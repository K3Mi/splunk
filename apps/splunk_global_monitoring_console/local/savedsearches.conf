##### Transfered ####
[Report on users logged on including the last time they logged into Splunk]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -7d@h
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["host","source","sourcetype","action","elapsedTime","remote_ttl","user","active_searches","index","server","search_id","kb","src_ip"]
display.general.type = statistics
display.page.search.mode = verbose
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunk_web_access method=GET status=200 uri_path="/*/app/*" file!="*.*" \
| rex "\w+\/(?<src_ip>\d+\.\d+\.\d+\.\d+)" \
| rex "(?<Browser>(Firefox|Chrome))" \
| rex "(?<Browser2>(Firefox|Mozilla|Chrome))" \
| eval src_ip = if(isnull(src_ip), "Unknown", src_ip) \
| eval Browser = if(isnull(Browser), Browser2, Browser) \
| eval user = upper(user) \
| stats latest(_time) as _time values(src_ip) as Client dc(src_ip) as Num_Clients values(Browser) as Browser values(app) as Apps_Used values(view) as Dashboards_Used dc(view) as Num_Dashboards_Used by user \
| rename user as Splunk_User \
| eval Last_Login = strftime(_time,"%m/%d/%Y %H:%M:%S") \
| lookup CCB_Splunk_SH_Users_Lookup_v1 user as Splunk_User OUTPUT name as Name email as Email roles as Roles\
| table Splunk_User Name Email Roles Num_Clients Client Last_Login Browser Apps_Used Num_Dashboards_Used Dashboards_Used

[dmc_assets Search]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -15m
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["host","source","sourcetype","splunk_server_group","component","log_level","message","search_group","index","Index_Name","Source_Name","Sourcetype_Name","uri","file"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup dmc_assets\
| search search_group = "dmc_customgroup_ccb_search_head_cluster"

[Report on License Usage by Indexer Cluster (Digital/CCB/UAT)]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -15m@m
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["Index_Name","Source_Name","Sourcetype_Name","uri","file","search","App","Saved_Search_App","search_id","Saved_Search_App2","priority","window_time","User","Savedsearch_Name","reason","Status","Scheduled_Time","Search_Type","message","Dispatch_Time","Total_Run_Time","Result_Count","Member_Label","alert_actions","Search_Type2","search_type","Search_Type3","Search_Type1"]
display.general.timeRangePicker.show = 0
display.general.type = visualizations
display.page.search.tab = visualizations
display.statistics.rowNumbers = 1
display.statistics.show = 0
display.visualizations.charting.chart.overlayFields = Total_License_Usage
display.visualizations.charting.chart.showDataLabels = all
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal host=vsin12p1061 source=*license_usage.log* type="RolloverSummary" earliest=-14d@d \
| rex field=host "(?<host>^\w+)" \
| eval splunk_server=upper(splunk_server), host=upper(host) \
| eval _time=_time - 43200 \
| bin _time span=1d \
| stats latest(b) AS b by slave, pool, _time \
| rename slave as Indexer_GUID \
| join \
    [ search index=_internal sourcetype=splunkd component=CMPeer earliest=-60m@m \
    | fields peer peer_name \
    | eval Indexer = upper(peer_name) \
    | rename peer as Indexer_GUID \
    | stats count by Indexer Indexer_GUID \
    | table Indexer Indexer_GUID] \
| eval Indexer_Cluster = case ( match(Indexer, "^ICP"), "CCB", match(Indexer, "-SPLN*K-IN*DX\d+"), "Digital", match(Indexer, "^PSIN|^ESO"), "UAT", true(), "Other") \
| eval volume=round(b/1024/1024/1024/1024, 2) \
| timechart span=1d sum(volume) AS "volume" fixedrange=false by Indexer_Cluster\
| eval Total_License_Usage = Digital + CCB + UAT

[splunk_web_access_kv_store_lookup_report]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = */5 * * * *
dispatch.earliest_time = -1s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = Dashboard
display.statistics.format.0.scale = sharedCategory
display.statistics.format.1 = color
display.statistics.format.1.colorPalette = sharedList
display.statistics.format.1.field = locator
display.statistics.format.1.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_web_access_kv_store_lookup \
| eval Days_Since_Latest_Access = round((now() - Latest_Access_Updated) / 86400 ) , Days_Since_Earliest_Access = round((now() - Earliest_Access_Updated) / 86400 ) \
| eval Latest_Access_Updated=strftime(Latest_Access_Updated,"%m/%d/%Y %H:%M:%S"), Earliest_Access_Updated=strftime(Earliest_Access_Updated,"%m/%d/%Y %H:%M:%S") \
| table Splunk_Role App Dashboard_Name User Earliest_Access_Updated Latest_Access_Updated Days_Since_Latest_Access Days_Since_Earliest_Access \
| where Splunk_Role="PROD-SHC-1"

[splunk_idx_audit_data_ingestion_kv_store_lookup_alert]
alert.expires = 1s
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
disabled = 1
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","host","event_message","component","log_level","userName","username","source","current_size","current_size_kb","blocked","largest_size","max_size_kb","smallest_size","index","splunk_server"]
display.general.type = statistics
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
enableSched = 1
quantity = 0
relation = greater than
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_idx_audit_data_ingestion_kv_store_lookup \
| search NOT host IN ("AN*", "AH*") \
| eval Splunk_Instance=lower(host) \
| lookup dmc_assets host as Splunk_Instance OUTPUT search_group \
| search index=_internal AND sourcetype=splunkd \
| eval Index_Time_Diff_Min = round((now() - Latest_Index_Time_Seen) / 60, 2) \
| eval Index_Time_Diff_Hours = round(Index_Time_Diff_Min / 60 , 2) \
| convert ctime(Earliest_Index_Time_Seen), ctime(Latest_Index_Time_Seen), ctime(Earliest_Time_Seen), ctime(Latest_Time_Seen) \
| table host index sourcetype source Earliest_Index_Time_Seen Latest_Index_Time_Seen Index_Time_Diff_Min Index_Time_Diff_Hours search_group \
| where Index_Time_Diff_Min > 60

[splunk_config_files_custom_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","splunk_server_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_config_files_custom_lookup \
| table Config_File Stanza Setting Current_Value Proposed_Value Stanza_Description Setting_Description \
| eval Config_File=trim(Config_File) , Stanza = trim(Stanza) , Setting = trim(Setting) \
| sort Config_File Stanza Setting \
| dedup Config_File Stanza Setting \
| outputlookup splunk_config_files_custom_lookup createinapp=true \
| stats count

[splunk_config_files_defaults_lookup_report]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","splunk_server_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = Setting
display.statistics.format.0.scale = sharedCategory
display.statistics.format.1 = color
display.statistics.format.1.colorPalette = sharedList
display.statistics.format.1.field = Setting
display.statistics.format.1.scale = sharedCategory
display.statistics.format.10 = color
display.statistics.format.10.colorPalette = sharedList
display.statistics.format.10.field = Setting
display.statistics.format.10.scale = sharedCategory
display.statistics.format.11 = color
display.statistics.format.11.colorPalette = sharedList
display.statistics.format.11.field = Setting
display.statistics.format.11.scale = sharedCategory
display.statistics.format.12 = color
display.statistics.format.12.colorPalette = sharedList
display.statistics.format.12.field = Default_Value
display.statistics.format.12.scale = sharedCategory
display.statistics.format.13 = color
display.statistics.format.13.colorPalette = sharedList
display.statistics.format.13.field = Current_Value
display.statistics.format.13.scale = sharedCategory
display.statistics.format.14 = color
display.statistics.format.14.colorPalette = sharedList
display.statistics.format.14.field = Proposed_Value
display.statistics.format.14.scale = sharedCategory
display.statistics.format.2 = color
display.statistics.format.2.colorPalette = sharedList
display.statistics.format.2.field = Default_Value
display.statistics.format.2.scale = sharedCategory
display.statistics.format.3 = color
display.statistics.format.3.colorPalette = sharedList
display.statistics.format.3.field = Setting
display.statistics.format.3.scale = sharedCategory
display.statistics.format.4 = color
display.statistics.format.4.colorPalette = sharedList
display.statistics.format.4.field = Setting
display.statistics.format.4.scale = sharedCategory
display.statistics.format.5 = color
display.statistics.format.5.colorPalette = sharedList
display.statistics.format.5.field = Default_Value
display.statistics.format.5.scale = sharedCategory
display.statistics.format.6 = color
display.statistics.format.6.colorPalette = sharedList
display.statistics.format.6.field = Current_Value
display.statistics.format.6.scale = sharedCategory
display.statistics.format.7 = color
display.statistics.format.7.colorPalette = sharedList
display.statistics.format.7.field = Setting
display.statistics.format.7.scale = sharedCategory
display.statistics.format.8 = color
display.statistics.format.8.colorPalette = sharedList
display.statistics.format.8.field = Setting
display.statistics.format.8.scale = sharedCategory
display.statistics.format.9 = color
display.statistics.format.9.colorPalette = sharedList
display.statistics.format.9.field = Default_Value
display.statistics.format.9.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_config_files_defaults_lookup \
| fields Config_File Stanza Stanza_Description Setting Setting_Description Default_Value Possible_Values \
| lookup splunk_config_files_custom_lookup Config_File Stanza Setting OUTPUT Current_Value Proposed_Value Setting_Description as Current_Setting_Description\
| sort Config_File Stanza Setting\
`comment("| where Stanza="shclustering" AND Current_Value!=Default_Value")`\
| eval Proposed_Value = case(match(Setting, ".ui-|.user-|.viewstates$"), "FALSE", true(), Proposed_Value) \
| eval Stanza_Out = "[" . Stanza . "]" , Setting_Out = Setting . " = " . Default_Value| where Stanza="shclustering" AND Current_Value!=Default_Value\
| table  Setting  Default_Value Current_Value Proposed_Value

[splunk_config_files_defaults_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","splunk_server_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_config_files_defaults_lookup \
| table Config_File Stanza Setting Default_Value Current_Value Proposed_Value Possible_Values Stanza_Description Setting_Description \
| sort Config_File Stanza Setting \
| dedup Config_File Stanza Setting \
| outputlookup splunk_config_files_defaults_lookup createinapp=true \
| stats count

[splunk_config_files_defaults_lookup_report_2]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","splunk_server_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = Setting
display.statistics.format.0.scale = sharedCategory
display.statistics.format.1 = color
display.statistics.format.1.colorPalette = sharedList
display.statistics.format.1.field = Setting
display.statistics.format.1.scale = sharedCategory
display.statistics.format.10 = color
display.statistics.format.10.colorPalette = sharedList
display.statistics.format.10.field = Setting
display.statistics.format.10.scale = sharedCategory
display.statistics.format.11 = color
display.statistics.format.11.colorPalette = sharedList
display.statistics.format.11.field = Setting
display.statistics.format.11.scale = sharedCategory
display.statistics.format.12 = color
display.statistics.format.12.colorPalette = sharedList
display.statistics.format.12.field = Default_Value
display.statistics.format.12.scale = sharedCategory
display.statistics.format.13 = color
display.statistics.format.13.colorPalette = sharedList
display.statistics.format.13.field = Current_Value
display.statistics.format.13.scale = sharedCategory
display.statistics.format.14 = color
display.statistics.format.14.colorPalette = sharedList
display.statistics.format.14.field = Proposed_Value
display.statistics.format.14.scale = sharedCategory
display.statistics.format.2 = color
display.statistics.format.2.colorPalette = sharedList
display.statistics.format.2.field = Default_Value
display.statistics.format.2.scale = sharedCategory
display.statistics.format.3 = color
display.statistics.format.3.colorPalette = sharedList
display.statistics.format.3.field = Setting
display.statistics.format.3.scale = sharedCategory
display.statistics.format.4 = color
display.statistics.format.4.colorPalette = sharedList
display.statistics.format.4.field = Setting
display.statistics.format.4.scale = sharedCategory
display.statistics.format.5 = color
display.statistics.format.5.colorPalette = sharedList
display.statistics.format.5.field = Default_Value
display.statistics.format.5.scale = sharedCategory
display.statistics.format.6 = color
display.statistics.format.6.colorPalette = sharedList
display.statistics.format.6.field = Current_Value
display.statistics.format.6.scale = sharedCategory
display.statistics.format.7 = color
display.statistics.format.7.colorPalette = sharedList
display.statistics.format.7.field = Setting
display.statistics.format.7.scale = sharedCategory
display.statistics.format.8 = color
display.statistics.format.8.colorPalette = sharedList
display.statistics.format.8.field = Setting
display.statistics.format.8.scale = sharedCategory
display.statistics.format.9 = color
display.statistics.format.9.colorPalette = sharedList
display.statistics.format.9.field = Default_Value
display.statistics.format.9.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_config_files_defaults_lookup \
| fields Config_File Stanza Stanza_Description Setting Setting_Description Default_Value Possible_Values\
| lookup config_default_settings.csv Config_File Stanza Setting OUTPUT Default_Value as si_Default_Value\
| where isnull(si_Default_Value)| sort Config_File Stanza Setting

[Splunk Enviroment Assets for ITSI Report]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup dmc_assets \
| eval host = upper(host) \
| stats count by host search_group \
| eval search_group_cleaned = if( match(search_group, "^dmc_customgroup"), search_group, null() ) \
| stats count by host search_group_cleaned \
| rex field=search_group_cleaned mode=sed "s/dmc_customgroup_//g" \
| rename search_group_cleaned as "Entity Description" \
| eval "Entity Title" = host \
| eval "Entity Alias" = 'Entity Description' , "Entity Information Field" = 'Entity Description' \
| table "Entity Title" host "Entity Description" "Entity Alias" "Entity Information Field"

[splunk_idx_audit_data_ingestion_kv_store_lookup_report]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = @s
dispatchAs = user
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","host","event_message","component","log_level","userName","username","source","current_size","current_size_kb","blocked","largest_size","max_size_kb","smallest_size","index","splunk_server"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = host
display.statistics.format.0.scale = sharedCategory
display.statistics.format.1 = color
display.statistics.format.1.colorPalette = sharedList
display.statistics.format.1.field = host
display.statistics.format.1.scale = sharedCategory
display.statistics.format.10 = color
display.statistics.format.10.colorPalette = sharedList
display.statistics.format.10.field = host
display.statistics.format.10.scale = sharedCategory
display.statistics.format.11 = color
display.statistics.format.11.colorPalette = sharedList
display.statistics.format.11.field = host
display.statistics.format.11.scale = sharedCategory
display.statistics.format.12 = color
display.statistics.format.12.colorPalette = minMidMax
display.statistics.format.12.colorPalette.maxColor = #AF575A
display.statistics.format.12.colorPalette.midColor = #FFFFFF
display.statistics.format.12.colorPalette.minColor = #62B3B2
display.statistics.format.12.field = Time_Diff_Mins
display.statistics.format.12.scale = minMidMax
display.statistics.format.12.scale.midType = percentile
display.statistics.format.12.scale.midValue = 50
display.statistics.format.13 = color
display.statistics.format.13.colorPalette = sharedList
display.statistics.format.13.field = index
display.statistics.format.13.scale = sharedCategory
display.statistics.format.14 = color
display.statistics.format.14.colorPalette = sharedList
display.statistics.format.14.field = sourcetype
display.statistics.format.14.scale = sharedCategory
display.statistics.format.2 = color
display.statistics.format.2.colorPalette = minMidMax
display.statistics.format.2.colorPalette.maxColor = #AF575A
display.statistics.format.2.colorPalette.midColor = #FFFFFF
display.statistics.format.2.colorPalette.minColor = #62B3B2
display.statistics.format.2.field = Time_Diff_Mins
display.statistics.format.2.scale = minMidMax
display.statistics.format.2.scale.midType = percentile
display.statistics.format.2.scale.midValue = 50
display.statistics.format.3 = color
display.statistics.format.3.colorPalette = sharedList
display.statistics.format.3.field = host
display.statistics.format.3.scale = sharedCategory
display.statistics.format.4 = color
display.statistics.format.4.colorPalette = sharedList
display.statistics.format.4.field = host
display.statistics.format.4.scale = sharedCategory
display.statistics.format.5 = color
display.statistics.format.5.colorPalette = minMidMax
display.statistics.format.5.colorPalette.maxColor = #AF575A
display.statistics.format.5.colorPalette.midColor = #FFFFFF
display.statistics.format.5.colorPalette.minColor = #62B3B2
display.statistics.format.5.field = Time_Diff_Mins
display.statistics.format.5.scale = minMidMax
display.statistics.format.5.scale.midType = percentile
display.statistics.format.5.scale.midValue = 50
display.statistics.format.6 = color
display.statistics.format.6.colorPalette = sharedList
display.statistics.format.6.field = index
display.statistics.format.6.scale = sharedCategory
display.statistics.format.7 = color
display.statistics.format.7.colorPalette = sharedList
display.statistics.format.7.field = host
display.statistics.format.7.scale = sharedCategory
display.statistics.format.8 = color
display.statistics.format.8.colorPalette = sharedList
display.statistics.format.8.field = host
display.statistics.format.8.scale = sharedCategory
display.statistics.format.9 = color
display.statistics.format.9.colorPalette = minMidMax
display.statistics.format.9.colorPalette.maxColor = #AF575A
display.statistics.format.9.colorPalette.midColor = #FFFFFF
display.statistics.format.9.colorPalette.minColor = #62B3B2
display.statistics.format.9.field = Time_Diff_Mins
display.statistics.format.9.scale = minMidMax
display.statistics.format.9.scale.midType = percentile
display.statistics.format.9.scale.midValue = 50
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_idx_audit_data_ingestion_kv_store_lookup \
| eval Index_Time_Diff_Mins = round((now() - Latest_Index_Time_Seen) / 60, 2) , Time_Diff_Mins = round((now() - Latest_Time_Seen) / 60, 2) , Index_Time_Diff_Hrs = round((now() - Latest_Index_Time_Seen) / 60 / 60, 2) , Index_Time_Diff_Days = round((now() - Latest_Index_Time_Seen) / 60 / 60 / 24, 2) , Time_Diff = round((Latest_Time_Seen - Earliest_Time_Seen) / 60, 2), Latency_Sec = Latest_Index_Time_Seen - Latest_Time_Seen \
| convert ctime(Earliest_Index_Time_Seen), ctime(Latest_Index_Time_Seen), ctime(Earliest_Time_Seen), ctime(Latest_Time_Seen) \
| table host index sourcetype  Latest_Time_Seen Latest_Index_Time_Seen Latency_Sec Time_Diff_Mins Earliest_Time_Seen  Index_Time_Diff_Mins Index_Time_Diff_Hrs Index_Time_Diff_Days Earliest_Index_Time_Seen  \
| where Time_Diff_Mins > 120\
| sort 0 - Time_Diff_Mins

[Identify Two Digit Year Timestamp Events Query (2020 Timestamp Issue)]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -15m@m
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["event_message","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4","Splunk_Env","Indexer_GUID","st","type","retry_timeout","request","pool_name","data_center","lagSecs","search","savedsearch_name","ApplicationName","date_mday","index"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = verbose
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = Splunk_ML_Toolkit.Scatter3dViz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=* TERM(19) \
| eval sample=substr(_raw,0,128), search="index=".index." sourcetype=".sourcetype." TERM(19)" \
| regex sample="(((?:^|\D)\d{1,2}[-\/]\d{1,2}[-\/]19[^\d])|((?:^|\D)19[-\/]\d{1,2}[-\/]\d{1,2}[^\d])|((?:^|\D)\d{1,2}\s[-\/]\s\d{1,2}\s[-\/]\s19[^\d])|((?:^|\D)19\s[-\/]\s\d{1,2}\s[-\/]\s\d{1,2}[^\d])|((?:^|\D)([a-zA-Z]{3}[- \/]+\d{1,2}[- \/]+19[^:\d]))|((?:^|\D)19[- \/][a-zA-Z]{3}[- \/]\d{1,2}[^:\d])|((?:^|\D)\d{1,2}[- \/]+[a-zA-Z]{3}[- \/]+19[^:\d]))" \
| stats count last(sample) as sample by search\
| table search sample count

[splunk_idx_audit_data_ingestion_kv_store_lookup_alert_entire_env]
alert.expires = 1s
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = */5 * * * *
dispatch.earliest_time = -1h
dispatch.latest_time = now
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","host","event_message","component","log_level","userName","username","source","current_size","current_size_kb","blocked","largest_size","max_size_kb","smallest_size","index","splunk_server"]
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = host
display.statistics.format.0.scale = sharedCategory
display.statistics.format.1 = color
display.statistics.format.1.colorPalette = list
display.statistics.format.1.colorPalette.colors = [#53A051,#F8BE34,#EC9960,#F1813F,#DC4E41]
display.statistics.format.1.field = Latest_Time_Seen_Hours
display.statistics.format.1.scale = threshold
display.statistics.format.1.scale.thresholds = [0,6,12,18]
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
enableSched = false
quantity = 0
relation = greater than
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_idx_audit_data_ingestion_kv_store_lookup \
| where source LIKE "%/splunkd.log" AND index="_internal" \
| eval Latest_Time_Seen_Min = round((now() - Latest_Time_Seen) / 60, 2) \
| eval Latest_Time_Seen_Hours = round(Latest_Time_Seen_Min / 60 , 2) , now=now() \
| convert ctime(Earliest_Time_Seen), ctime(Latest_Time_Seen) , ctime(now) \
| table host Earliest_Time_Seen Latest_Time_Seen now Latest_Time_Seen_Hours Latest_Time_Seen_Min \
| where Latest_Time_Seen_Hours > 12\
| sort - Latest_Time_Seen_Hours

[sid_info_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = 0
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4","Splunk_Env","splunk_server_group","splunk_server","Indexer_GUID","st","type"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup sid_info_lookup \
    `comment("| rename "Standard ID" AS Standard_ID "Full Name" AS Full_Name "Worker Status" AS Worker_Status "ID Status" AS ID_Status "Surviving SID" AS Surviving_SID "Entry Type" AS Entry_Type "Hire Date" AS Hire_Date "Termination Date" AS Termination_Date "Contractor Expiration" AS Contractor_Expiration "Company Number" AS Company_Number "Cost Center" AS Cost_Center "Department Description" AS Department_Description "Direct Manager SID" AS Direct_Manager_SID "Manager Name" AS Manager_Name "LOB" AS LOB "Job Code" AS Job_Code "Job Code Description" AS Job_Code_Description "Bear Stearns SNACS ID" AS Bear_Stearns_SNACS_ID "WaMu EMPLID" AS WaMu_EMPLID "WaMu UID" AS WaMu_UID "SORTCODE" AS SORTCODE "Mail Code" AS Mail_Code "HR Location Code" AS HR_Location_Code "HR Address" AS HR_Address "Floor Number" AS Floor_Number "HR City" AS HR_City "HR State" AS HR_State "HR Country Code" AS HR_Country_Code "HR Zip" AS HR_Zip "Email" AS Email "Phone" AS Phone "FAX" AS FAX "HR Region" AS HR_Region "Mail Location Code" AS Mail_Location_Code "Mail Address" AS Mail_Address "Mail City" AS Mail_City "Mail State" AS Mail_State "Mail Country Code" AS Mail_Country_Code "Mail Country Code Name" AS Mail_Country_Code_Name "Mail Zip" AS Mail_Zip "Mail Region" AS Mail_Region "Beeline Flag" AS Beeline_Flag ")` \
| fields Standard_ID Full_Name Worker_Status ID_Status Surviving_SID Entry_Type Hire_Date Termination_Date Contractor_Expiration Company_Number Cost_Center Department_Description Direct_Manager_SID Manager_Name LOB Job_Code Job_Code_Description Bear_Stearns_SNACS_ID WaMu_EMPLID WaMu_UID SORTCODE Mail_Code HR_Location_Code HR_Address Floor_Number HR_City HR_State HR_Country_Code HR_Zip Email Phone FAX HR_Region Mail_Location_Code Mail_Address Mail_City Mail_State Mail_Country_Code Mail_Country_Code_Name Mail_Zip Mail_Region Beeline_Flag \
| eval Standard_ID = upper(Standard_ID) , Email = lower(Email) \
| rex field=Full_Name mode=sed "s/\s{2,}/ /g" \
| rex field=Department_Description mode=sed "s/\s{2,}/ /g" \
| rex field=Manager_Name mode=sed "s/\s{2,}/ /g" \
    `comment("| eval HR_State_Len=len(HR_State)\
| eval HR_Country_Code = if(isnull(HR_Country_Code) AND HR_State_Len = 2, "United States", HR_Country_Code)\
| lookup country_names.csv ISO3 as HR_Country_Code OUTPUT Country_Name \
| rename Country_Name as HR_Country_Code ")` \
| stats last(*) as * by Standard_ID \
| eval HR_City=if(HR_City=0, null(),HR_City), Job_Code_Description=if(Job_Code_Description=0, null(),Job_Code_Description) , HR_State=if(HR_State=0, null(),HR_State) , Email=if(Email=0, null(),Email) \
| eval HR_Country_Code = case(\
    match(HR_City, "Bengaluru|Hyderabad|Mumbai|Pune|Chennai"), "India", \
    HR_City="Buenos Aires", "Argentina", \
    HR_City="Dublin", "Ireland", \
    HR_City="Frankfurt", "Germany", \
    HR_City="Hong Kong", "China", \
    match(HR_City, "London|Bournemouth|Glasgow"), "United Kingdom", \
    HR_City="Sao Paulo", "Brazil", \
    HR_City="Singapore", "Singapore", \
    HR_City="Taguig City", "Philippines", \
    HR_Country_Code="USA", "United States",\
    HR_Country_Code="IND", "India",\
    HR_Country_Code="ARG", "Argentina",\
    true(), HR_Country_Code) \
| table Standard_ID Full_Name Worker_Status ID_Status Surviving_SID Entry_Type Hire_Date Termination_Date Contractor_Expiration Company_Number Cost_Center Department_Description Direct_Manager_SID Manager_Name LOB Job_Code Job_Code_Description Bear_Stearns_SNACS_ID WaMu_EMPLID WaMu_UID SORTCODE Mail_Code HR_Location_Code HR_Address Floor_Number HR_City HR_State HR_Country_Code HR_Zip Email Phone FAX HR_Region Mail_Location_Code Mail_Address Mail_City Mail_State Mail_Country_Code Mail_Country_Code_Name Mail_Zip Mail_Region Beeline_Flag `comment(" | outputlookup sid_info_lookup createinapp=true  | stats count ")`

[Splunk _internal forwarding Time Drift Search]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -15m
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","source","host","series","index","search_type","DATE_TIME__UTC_","sourceTimeStamp","timeendpos","timestartpos"]
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = number
display.statistics.format.0.field = time_drift
display.statistics.format.0.unit = Seconds
display.statistics.format.1 = number
display.statistics.format.1.field = time_drift
display.statistics.format.1.unit = Seconds
display.statistics.format.2 = number
display.statistics.format.2.field = time_drift
display.statistics.format.2.unit = Seconds
display.statistics.format.3 = number
display.statistics.format.3.field = time_drift
display.statistics.format.3.unit = Seconds
display.statistics.rowNumbers = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
display.visualizations.type = custom
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal host=* \
| fields _time host index _indextime \
| eval Now=now() \
| stats latest(Now) as Now latest(_time) as _time latest(_indextime) as Indextime by host \
| eval time_drift=now() - _time \
| eval time_drift_human=case( round(time_drift / (3600*24) - 0.5) > 0, round(time_drift / (3600*24) - 0.5)."d ".round((time_drift % (3600*24)) / 3600 - 0.5)."h ".round((time_drift % 3600) / 60 - 0.5)."min ".round(time_drift % 60, 2)."s", round((time_drift % (3600*24)) / 3600 - 0.5) > 0, round((time_drift % (3600*24)) / 3600 - 0.5)."h ".round((time_drift % 3600) / 60 - 0.5)."min ".round(time_drift % 60, 2)."s", round((time_drift % 3600) / 60 - 0.5) > 0, round((time_drift % 3600) / 60 - 0.5)."min ".round(time_drift % 60, 2)."s", 1 = 1, round(time_drift % 60, 2)."s" ) \
| convert ctime(Indextime) , ctime(Now) \
| table host Now _time Indextime time_drift time_drift_human \
| where time_drift > 300 \
| sort 0 - time_drift

[splunk_sh_dm_audit_view_activity_kv_store_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 2 * * *
dispatch.earliest_time = 0
display.events.fields = ["host","source","sourcetype","splunk_server_group","component","log_level","message","search_group","index","Index_Name","Source_Name","Sourcetype_Name","uri","file"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | tstats summariesonly=f allow_old_summaries=true \
    count as Access_Count\
    latest(_time) as Latest_Access\
    earliest(_time) as Earliest_Access\
    values(host) as Search_Heads\
    dc(host) as num_Search_Heads\
    latest(View_Activity.uri) as Dashboard_URL\
    values(View_Activity.user) as Users\
    dc(View_Activity.user) as Num_Users\
    FROM datamodel=Splunk_Audit.View_Activity \
    WHERE View_Activity.view != "home" AND View_Activity.view != "search" AND View_Activity.view != "dashboard*" View_Activity.view != "alert*" AND View_Activity.view != "report*" AND View_Activity.view != "field_extractor" AND View_Activity.view != "job_manager" AND View_Activity.view != "dataset*" AND View_Activity.view != "pivot" AND View_Activity.view != "show_source" AND View_Activity.view != "charting" AND View_Activity.view != "data_model*" AND View_Activity.view != "flashtimeline" AND View_Activity.view != "integrity_check_of_installed_files" AND View_Activity.view != "licenseusage" AND View_Activity.view != "live_tail" AND View_Activity.view != "mod_setup" AND View_Activity.view != "orphaned_scheduled_searches" \
    AND View_Activity.app != "system" AND View_Activity.app != "splunk_*" AND View_Activity.app != "alert_manager" AND View_Activity.app != "*_app" AND View_Activity.app != "lookup_editor" AND View_Activity.app != "Splunk_*" AND View_Activity.app != "simple_xml_examples" AND View_Activity.app != "TA-*"\
    BY View_Activity.app View_Activity.view \
| rename "View_Activity.*" as "*" \
| rename app as App, view as Dashboard \
| rex field=Dashboard_URL mode=sed "s/\\?.*$//g" \
| rex field=Dashboard_URL mode=sed "s/\\/edit$|\/editxml$//g" \
| eval Dashboard_URL = "https://ccbloga.jpmchase.net" . Dashboard_URL \
| eval Users = upper(Users) \
| table App Dashboard Dashboard_URL Users Num_Users Earliest_Access Latest_Access num_Search_Heads Search_Heads Access_Count \
| outputlookup shc_splunk_audit_view_activity_kv_store_lookup createinapp=true create_empty=true append=false \
| stats count

[splunk_fields_lookup_update]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = 0
dispatchAs = user
display.events.fields = ["acceleration_id","app","delta_scan_count","elapsed","fd_used","label","mem_used","mode","page_faults","pct_cpu","pct_memory","pid","provenance","punct","read_mb","role","scan_count","sid","status","t_count","type","user","written_mb"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_fields_lookup \
| table Index Component Sub_Component Field_Name Field_Display_Name Field_Description \
| sort Index Component Sub_Component Field_Name \
| rex field=Field_Description mode=sed "s/\s{2,}/ /g"\
| eval Field_Description=trim(Field_Description)\
| outputlookup splunk_fields_lookup

[splunk_sh_index_internal_scheduler_jobs_kv_store_lookup_report]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s
dispatch.latest_time = now
dispatchAs = user
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_index_internal_scheduler_jobs_kv_store_lookup \
| fields Splunk_Role Splunk_Instance Savedsearch_Name App User Scheduled_Time Priority Dispatch_Time Window_Time Earliest_Run_Time Latest_Run_Time Run_Time Result_Count \
| eval Lag_Time_Min = round((Dispatch_Time - Scheduled_Time) / 60, 2) , Run_Time_Min = round(Run_Time / 60, 2) \
| convert ctime(Scheduled_Time), ctime(Dispatch_Time), ctime(Earliest_Run_Time), ctime(Latest_Run_Time) \
| table Splunk_Role Savedsearch_Name App User Scheduled_Time Dispatch_Time Latest_Run_Time Lag_Time_Min Run_Time_Min Run_Time Result_Count

[splunk_assets_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup dmc_assets \
| eval host = upper(host) \
| eval search_group = if( match(search_group, "^dmc_customgroup"), search_group, null() ) \
| rex field=search_group mode=sed "s/dmc_customgroup_//g" \
| stats count by host search_group \
| rename search_group AS Splunk_Role \
| table host Splunk_Role \
| outputlookup splunk_assets_lookup createinapp=true create_empty=true override_if_empty=false \
| stats count

[splunk_sh_rest_saved_searches_kv_store_lookup_gen]
action.email.include.search = 1
action.email.inline = 1
action.email.sendresults = 1
action.email.to = amir.khamis@chase.com
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 4 * * *
dispatch.earliest_time = -1s
dispatch.latest_time = now
display.events.fields = ["source","BaseSearch","Search","Searches","active_searches","phone","pii_phone","Phone","pii_account","pii_email","pii_email_fixed","splunk_server","eaiApp","app","Aacl_app","form_App","form_app","form_application_index","app_only","user","run_time","status","success","dispatch_time","digest_mode","savedsearch_name","savedsearch_id","suppressed","window_time","concurrency_category","concurrency_context","concurrency_limit","reason","priority","member_label","scheduled_time","search_type","skipped"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = savedsearch_type1
display.statistics.format.0.scale = sharedCategory
display.statistics.format.1 = color
display.statistics.format.1.colorPalette = sharedList
display.statistics.format.1.field = savedsearch_type2
display.statistics.format.1.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /servicesNS/-/-/saved/searches timeout=0 earliest_time=-24h@h latest_time=now \
| eval savedsearch_type=if((NOT 'action'=="*" AND NOT alert.track=="*" AND NOT alert_condition=="*" AND 'alert_type'=="always"),"report","alert") \
| rename eai:acl.app AS app, title AS savedsearch_name, alert.severity AS alert_severity, alert.track AS alert_track, dispatch.earliest_time AS dispatch_earliest_time, dispatch.latest_time AS dispatch_latest_time , eai:acl.sharing as sharing , eai:acl.owner as owner , eai:acl.removable as removable \
| rex field=search max_match=0 "lookup\s(?<Lookup_Reference>\w+)" \
| eval Lookup_Reference=mvsort(mvdedup(Lookup_Reference)) \
| rex field=search max_match=0 "[fF][rR][oO][mM]\s*[dD][aA][tT][aA][mM][oO][dD][eE][lL]\s*=\s*\"?(?<Datamodel_Reference>.*?)\"?\s" \
| eval Datamodel_Reference=mvdedup(Datamodel_Reference) \
| fields savedsearch_name savedsearch_type author updated app description cron_schedule schedule_window realtime_schedule schedule_priority allow_skew alert_severity alert_track alert_type dispatch_earliest_time dispatch_latest_time auto_summarize max_concurrent next_scheduled_time search scheduled_times disabled is_scheduled is_visible owner removable run_n_times run_on_startup splunk_server sharing Lookup_Reference Datamodel_Reference \
| `get_splunk_env(splunk_server)` \
| eval updated=strftime(strptime(updated, "%Y-%m-%dT%H:%M:%S%z"),"%m/%d/%Y %H:%M:%S") \
| eval next_scheduled_time=strftime(strptime(next_scheduled_time, "%Y-%m-%d %H:%M:%S %Z"),"%m/%d/%Y %H:%M:%S") \
| eval scheduled_times=strftime(scheduled_times,"%m/%d/%Y %H:%M:%S") \
| stats values(splunk_server) as splunk_server values(scheduled_times) as scheduled_times values(Lookup_Reference) as Lookup_Reference values(Datamodel_Reference) as Datamodel_Reference last(*) AS * dc(scheduled_times) as dc_scheduled_times BY Splunk_Role app savedsearch_name \
| table Splunk_Role splunk_server app savedsearch_name description savedsearch_type sharing author owner updated disabled is_visible is_scheduled cron_schedule scheduled_times next_scheduled_time dc_scheduled_times auto_summarize dispatch_earliest_time dispatch_latest_time schedule_priority max_concurrent schedule_window allow_skew realtime_schedule alert_severity alert_track alert_type removable run_n_times run_on_startup Lookup_Reference Datamodel_Reference search \
| outputlookup shc_saved_searches_rest_kv_store_lookup createinapp=true create_empty=true override_if_empty=false \
| stats count

[Dashboard Usage Report Across all Nodes in the Search Head Cluster]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -7d@h
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["host","source","sourcetype","fill_perc","info","method","Aacl_app"]
display.events.type = raw
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.chartHeight = 773
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_monitoring_console
request.ui_dispatch_view = search
search = | rest splunk_server_group=dmc_group_search_head /servicesNS/-/-/data/ui/views \
| rename eai:data as data eai:appName as app \
| where isDashboard=1 AND disabled=0 AND isVisible=1 AND rootNode="dashboard" \
| rex field=data "<query>\n*(?<query>[^<]+)" \
| stats values(query) as query count by app title label \
| join type=outer app title \
    [ search index=_internal splunk_server_group=dmc_group_search_head sourcetype=splunk_web_access method=GET app \
    | rex "GET /[^/]+/app/(?<app>[^/ ?]+)/(?<title>[^\/\?\s]+)" \
    | stats dc(user) AS dc_users values(user) as users by app, title ] \
| table splunk_server app label users dc_users query \
| sort 0 - dc_users

[License Usage - Previous 30 Days - From metrics.log]
action.email.useNSSubject = 1
alert.track = 0
auto_summarize.dispatch.earliest_time = -7d@d
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","source","host"]
display.general.timeRangePicker.show = 0
display.statistics.rowNumbers = 1
display.visualizations.charting.axisTitleX.text = Time
display.visualizations.charting.axisTitleY.text = TB
display.visualizations.charting.axisY.abbreviation = auto
display.visualizations.charting.axisY.scale = log
display.visualizations.charting.chart.overlayFields = Total_License_Usage
display.visualizations.custom.number_display_viz.number_display_viz.bordercolor = #FFFFFF
display.visualizations.custom.number_display_viz.number_display_viz.bordersize = 2
display.visualizations.custom.number_display_viz.number_display_viz.colorprimary = #000000
display.visualizations.custom.number_display_viz.number_display_viz.colorprimarymode = auto
display.visualizations.custom.number_display_viz.number_display_viz.colorsecondary = #000000
display.visualizations.custom.number_display_viz.number_display_viz.colorsecondarymode = darker1
display.visualizations.custom.number_display_viz.number_display_viz.max = 100
display.visualizations.custom.number_display_viz.number_display_viz.min = 0
display.visualizations.custom.number_display_viz.number_display_viz.nodatacolor = #0178c7
display.visualizations.custom.number_display_viz.number_display_viz.padding = 10
display.visualizations.custom.number_display_viz.number_display_viz.pulserate = 4
display.visualizations.custom.number_display_viz.number_display_viz.shadowcolor = #F2F4F5
display.visualizations.custom.number_display_viz.number_display_viz.shapebordercolor = #FFFFFF
display.visualizations.custom.number_display_viz.number_display_viz.shapebordercolormode = static
display.visualizations.custom.number_display_viz.number_display_viz.shapebordersize = 1
display.visualizations.custom.number_display_viz.number_display_viz.shapedropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.shapeshadow = 1
display.visualizations.custom.number_display_viz.number_display_viz.shapetexture = solid
display.visualizations.custom.number_display_viz.number_display_viz.sparkHeight = 30
display.visualizations.custom.number_display_viz.number_display_viz.sparkWidth = 90
display.visualizations.custom.number_display_viz.number_display_viz.sparkalign = 5
display.visualizations.custom.number_display_viz.number_display_viz.sparkalignv = 70
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolorfill = #009DD9
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolorline = #0178c7
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolormodefill = auto
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolormodeline = auto
display.visualizations.custom.number_display_viz.number_display_viz.sparkmin = 0
display.visualizations.custom.number_display_viz.number_display_viz.sparknulls = gaps
display.visualizations.custom.number_display_viz.number_display_viz.sparkorder = bg
display.visualizations.custom.number_display_viz.number_display_viz.sparkstyle = area
display.visualizations.custom.number_display_viz.number_display_viz.spinnerspeedmax = 20
display.visualizations.custom.number_display_viz.number_display_viz.spinnerspeedmin = 1
display.visualizations.custom.number_display_viz.number_display_viz.style = g1
display.visualizations.custom.number_display_viz.number_display_viz.subtitlealign = center
display.visualizations.custom.number_display_viz.number_display_viz.subtitlealignv = 70
display.visualizations.custom.number_display_viz.number_display_viz.subtitlecolor = #5C6773
display.visualizations.custom.number_display_viz.number_display_viz.subtitlecolormode = static
display.visualizations.custom.number_display_viz.number_display_viz.subtitledrop = 1
display.visualizations.custom.number_display_viz.number_display_viz.subtitledropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.subtitlesize = 40
display.visualizations.custom.number_display_viz.number_display_viz.textalign = center
display.visualizations.custom.number_display_viz.number_display_viz.textalignv = 50
display.visualizations.custom.number_display_viz.number_display_viz.textcolor = #000000
display.visualizations.custom.number_display_viz.number_display_viz.textdrop = 1
display.visualizations.custom.number_display_viz.number_display_viz.textdropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.textduration = 300
display.visualizations.custom.number_display_viz.number_display_viz.textmode = static
display.visualizations.custom.number_display_viz.number_display_viz.textprecision = 1
display.visualizations.custom.number_display_viz.number_display_viz.textsize = 100
display.visualizations.custom.number_display_viz.number_display_viz.textunitposition = after
display.visualizations.custom.number_display_viz.number_display_viz.textunitsize = 50
display.visualizations.custom.number_display_viz.number_display_viz.thickness = 50
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol1 = #1a9035
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol2 = #d16f18
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol3 = #b22b32
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol4 = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol5 = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol6 = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.thresholdsize = 20
display.visualizations.custom.number_display_viz.number_display_viz.thresholdval2 = 70
display.visualizations.custom.number_display_viz.number_display_viz.thresholdval3 = 90
display.visualizations.custom.number_display_viz.number_display_viz.titlealign = center
display.visualizations.custom.number_display_viz.number_display_viz.titlealignv = 30
display.visualizations.custom.number_display_viz.number_display_viz.titlecolor = #5C6773
display.visualizations.custom.number_display_viz.number_display_viz.titlecolormode = static
display.visualizations.custom.number_display_viz.number_display_viz.titledrop = 1
display.visualizations.custom.number_display_viz.number_display_viz.titledropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.titlesize = 45
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = status_indicator_app.status_indicator
display.visualizations.show = 0
display.visualizations.trellis.size = large
display.visualizations.trellis.splitBy = Splunk_Env
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunkd source="/opt/splunk/var/log/splunk/metrics.log" group=per_host_thruput splunk_server_group=dmc_group_indexer earliest=-7d@d latest=-0d@d

[New License Usage By Index Report  - Under Dev]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -7d@h
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4","Splunk_Env","splunk_server_group","splunk_server","Indexer_GUID","st","type"]
display.general.timeRangePicker.show = 0
display.general.type = visualizations
display.page.search.tab = visualizations
display.statistics.format.0 = number
display.statistics.format.0.field = VolumeB
display.statistics.format.0.precision = 0
display.statistics.rowNumbers = 1
display.statistics.show = 0
display.statistics.totalsRow = 1
display.statistics.wrap = 0
display.visualizations.charting.chart.overlayFields = Total_License_Usage
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunkd source=*license_usage.log*\
| eval _time=_time - 43200 \
| eval h=if(len(h)=0 OR isnull(h),"(SQUASHED)",h) \
| eval s=if(len(s)=0 OR isnull(s),"(SQUASHED)",s) \
| eval idx=if(len(idx)=0 OR isnull(idx),"(UNKNOWN)",idx) \
| where h!="(SQUASHED)" AND s!="(SQUASHED)" AND idx!="(UNKNOWN)"\
| eval Volume=round(b/1024/1024/1024, 2) \
| timechart sum(Volume) as Volume by idx span=1d fixedrange=false

[Rajesh Calculated Fields needs to move]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -15m@m
dispatch.latest_time = now
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_data_props_calcfields_csv_lookup \
| eval updated=strftime(updated,"%m/%d/%Y %H:%M:%S") \
| makemv delim=" " splunk_server \
| table Splunk_Role splunk_server app sharing stanza name value title attribute author updated

[Rajesh Dashboards to Move from search to the respective Apps]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = 0
dispatchAs = user
display.events.fields = ["host","source","sourcetype","app","file_name","file_size","log_level","event_message","index","accountAliasName","accountOrganizationCode","accountOrganizationCodeDescription","accountReferenceNumber","accountRelationshipStatus","accounts","accountStatusReasons","accountType","accountWithinSafeHarbourPeriod","cardRelatedDepositAccountIdentifier","creditAccountDetailsList","creditAccountList","debitAccountDetailsList","debitAccountList","digitalAccountIdentifier","isAccountInGoodStanding"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_data_ui_dashboards_lookup \
| fields Splunk_Role splunk_server app sharing title label description type dashboard_size author location removable updated data Report_Reference Dashboard_Reference Lookup_Reference \
| rename Splunk_Role as Search_Head , title as Dashboard_Title, label as Dashboard_Name , updated as Dashboard_Last_Updated , app as App , location as Dashboard_Location, sharing as Dashboard_App_Sharing , description as Description, dashboard_size as Dashboard_Size \
| eval Author = case(author="NOBODY", "SYSTEM", true(), author) \
| stats list(App) as Apps dc(App) as Num_Apps list(Dashboard_Name) as Dashboard_Name list(Author) as Author list(Dashboard_App_Sharing) as Dashboard_App_Sharing by Dashboard_Title \
| table Dashboard_Title Dashboard_Name Author Apps Dashboard_App_Sharing

[Report on Logged-In Users - Previous 24 Hours]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","source","host"]
display.general.type = visualizations
display.page.search.mode = fast
display.page.search.tab = visualizations
display.statistics.rowNumbers = 1
display.statistics.show = 0
display.visualizations.charting.axisTitleX.visibility = collapsed
display.visualizations.charting.axisTitleY.visibility = collapsed
display.visualizations.charting.chart.nullValueMode = connect
display.visualizations.charting.chart.showDataLabels = all
display.visualizations.charting.chart.stackMode = stacked100
display.visualizations.charting.layout.splitSeries = 1
display.visualizations.charting.legend.placement = bottom
display.visualizations.custom.splunk_monitoring_console.heatmap.baseColor = #a34a41
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = departures-board-viz.departures-board-viz
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_audit sourcetype=audittrail user=* "action=login attempt" action="success" \
| eval User = upper(trim(user)) , Splunk_Instance = trim(upper(dest)) , Login_Source = upper(src), User_Length=len(user) , locator=md5(lower(User)) , All_Time=_time \
| `get_splunk_env(search_group)` \
| fields _time All_Time locator User User_Length Login_Source Splunk_Instance Splunk_Role \
| table _time User Login_Source Splunk_Role Splunk_Instance \
| timechart count(User) as User BY Splunk_Role span=5m \
| eval Total_Users = 'PROD-SHC-1' + 'PROD-SHC-2' + 'PROD-MC-2' + 'PROD-CM-1' + 'PROD-CM-2' + 'UAT-SHC-1' + 'UAT-CM-1' + 'PROD-SH'

[Report on Max Concurrent Searches vs Concurrent Search Limit by SHC Member]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -4h@m
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["event_message","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4","Splunk_Env","Indexer_GUID","st","type","retry_timeout","request","pool_name","data_center","lagSecs","search","savedsearch_name","ApplicationName","index","sourcetype","Latency_Sec","time","indextime","run_time","window_time","dispatch_time","scheduled_time","source","active_realtime_searches","active_hist_searches","splunk_server","splunk_server_group","log_level","component","max_hist_scheduled_searches"]
display.general.timeRangePicker.show = 0
display.general.type = visualizations
display.page.search.mode = fast
display.page.search.tab = visualizations
display.statistics.rowNumbers = 1
display.statistics.show = 0
display.statistics.totalsRow = 1
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.charting.chart.nullValueMode = connect
display.visualizations.charting.chart.showDataLabels = minmax
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = Splunk_ML_Toolkit.Scatter3dViz
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunkd source="*metrics.log" component=Metrics group="search_concurrency" event_message="*system total*" NOT user=* \
| fields _time active_hist_searches \
| eval max_hist_scheduled_searches = 867 \
| timechart sum(active_hist_searches) AS "Max Concurrent Searches" max(max_hist_scheduled_searches) AS "Concurrent Search Limit" span=30s

[Report on Production indexer Queues]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -60m@m
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","sourcetype","event_message","log_level","index","search_group","splunk_server_group","group"]
display.general.type = visualizations
display.page.search.mode = fast
display.page.search.tab = visualizations
display.statistics.rowNumbers = 1
display.statistics.show = 0
display.visualizations.charting.axisTitleX.visibility = collapsed
display.visualizations.charting.axisTitleY.visibility = collapsed
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = connect
display.visualizations.charting.layout.splitSeries = 1
display.visualizations.charting.legend.placement = bottom
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal source=*metrics.log sourcetype=splunkd group=queue name IN (aggqueue, indexqueue, parsingqueue, typingqueue) \
| eval name=case(name=="aggqueue","2 - Aggregation Queue",name=="indexqueue","4 - Indexing Queue",name=="parsingqueue","1 - Parsing Queue",name=="typingqueue","3 - Typing Queue") \
| eval ingest_pipe = if(isnotnull(ingest_pipe), ingest_pipe, "none") \
| eval current_size_mb=round(current_size_kb/1024) ,max_size_mb=round(max_size_kb/1024) \
| fields _time current_size_mb name \
| timechart avg(current_size_mb) as avg_current_size_mb by name span=1m

[Report on all UDP & TCP Data Ingestion via the HF Tier]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -7d@h
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["event_message","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4","Splunk_Env","Indexer_GUID","st","type","retry_timeout","request"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.statistics.totalsRow = 1
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | tstats count where index=* AND (source="tcp:*" OR source="udp:*" )\
    by splunk_server source host index sourcetype \
| fields source host index sourcetype \
| rex field=source "(?<Protocol>\w+):(?<Port>\d+)" \
| stats values(*) as * dc(host) as dc_host dc(index) as dc_index dc(sourcetype) as dc_sourcetype values(Protocol) as Protocol count \
    by Port \
| table Port Protocol dc_sourcetype sourcetype dc_index index dc_host count

[Top 20 Memory-Consuming Searches with the actual search executed]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -15m
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["exec_time","search_et","search_lt","duration_command_search_index","timestamp","total_run_time","savedsearch_name","maxtime","info","scan_count","user","search","reason","search_type","status","window_time","priority","message","Scheduler_Status","schedule_status","name","group","component","host","channel","uri","app","data.elapsed","data.fd_used","data.mem_used","data.normalized_pct_cpu","data.page_faults","data.pct_cpu","data.pct_memory","data.pid","data.ppid","data.process","data.process_type","data.read_mb","data.search_props.app","data.search_props.delta_scan_count","data.search_props.label","data.search_props.mode","data.search_props.provenance","data.search_props.role","data.search_props.scan_count","data.search_props.sid","data.search_props.type","data.search_props.user","data.status","data.t_count","data.written_mb","date_hour","date_mday","date_minute","date_month","date_second","date_wday","date_year","date_zone","datetime","elapsed","index","label","linecount","log_level","machine","mem_used","mode","pct_cpu","pct_memory","pid","ppid","process","provenance","punct","role","search_group","search_head","sid","source","sourcetype","splunk_server","splunk_server_group","type"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = verbose
display.page.search.patterns.sensitivity = 0.3
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = minMidMax
display.statistics.format.0.colorPalette.maxColor = #FFFFFF
display.statistics.format.0.colorPalette.minColor = #D6563C
display.statistics.format.0.field = mem_used_mb
display.statistics.format.0.scale = minMidMax
display.statistics.format.1 = number
display.statistics.format.1.field = mem_used_mb
display.statistics.format.1.unit = GB
display.statistics.format.2 = color
display.statistics.format.2.colorPalette = sharedList
display.statistics.format.2.field = User
display.statistics.format.2.scale = sharedCategory
display.statistics.format.3 = color
display.statistics.format.3.colorPalette = minMidMax
display.statistics.format.3.colorPalette.maxColor = #D6563C
display.statistics.format.3.colorPalette.midColor = #ED8440
display.statistics.format.3.colorPalette.minColor = #65A637
display.statistics.format.3.field = mem_used_gb
display.statistics.format.3.scale = minMidMax
display.statistics.format.3.scale.midType = percent
display.statistics.format.3.scale.midValue = 50
display.statistics.format.4 = number
display.statistics.format.4.field = mem_used_gb
display.statistics.format.4.unit = GB
display.statistics.format.5 = color
display.statistics.format.5.colorPalette = sharedList
display.statistics.format.5.field = SID
display.statistics.format.5.scale = sharedCategory
display.statistics.rowNumbers = 1
display.visualizations.chartHeight = 773
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = splunk_monitoring_console.KpiTrafficLight
display.visualizations.show = 0
request.ui_dispatch_app = splunk_monitoring_console
request.ui_dispatch_view = search
search = `dmc_set_index_introspection` sourcetype=splunk_resource_usage data.search_props.sid::* data.search_props.mode!=RT\
| `dmc_rename_introspection_fields` \
| stats max(elapsed) as runtime max(mem_used) as mem_used earliest(_time) as _time by sid, label, provenance, type, mode, app, role, search_head, user \
| eval mem_used = round(mem_used, 2) \
| sort 20 - mem_used \
| fields - day, hour, minute, second \
| eval _time = strftime(_time,"%+") \
| rename sid as SID, label as "Search Name", provenance AS Provenance, type as Type, mode as Mode, app as App, role as Role, search_head as "Search Head", user as User, mem_used as mem_used_mb, _time as Started, runtime as Runtime \
| fieldformat Runtime = `dmc_convert_runtime(Runtime)` \
| eval User=upper(User), mem_used_gb=round(mem_used_mb/1024, 2) \
| table User SID mem_used_gb "Search Name" Provenance Type App Started Runtime Mode Role \
| where mem_used_gb > 1 \
| sort 0 - mem_used_gb \
| join SID \
    [| search index=_internal sourcetype=splunkd_remote_searches \
    | fields search_id search \
    | stats values(search) as search dc(search) as dc_search by search_id \
    | rex field=search_id "remote_\w+_(?<SID>.*?)$" \
    | table SID search_id dc_search search]\
| table User SID mem_used_gb "Search Name" Provenance Type App Started Runtime Mode Role search

[splunk_sh_index_audit_user_login_kv_store_lookup_tracker]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = */5 * * * *
description = Track Users Login Into Splunk in both Prod & UAT
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
display.events.fields = ["index","source","sourcetype","component","user","file","action","info","app","dest","src","Vendor_Action"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_audit sourcetype=audittrail user=* "action=login attempt" action="success" earliest=-10m@m latest=-5m@m \
| eval User = upper(trim(user)) , Splunk_Instance = trim(upper(dest)) , Login_Source = upper(src), User_Length=len(user) , locator=md5(lower(User)) \
| `get_splunk_env(Splunk_Instance)` \
| fields _time locator User User_Length Login_Source Splunk_Instance Splunk_Role \
| lookup splunk_sh_index_audit_user_login_kv_store_lookup User OUTPUT Splunk_Role AS Splunk_Role_KV Login_Source AS Login_Source_KV \
| stats \
    earliest(_time) as Earliest_Login_Updated \
    latest(_time) as Latest_Login_Updated \
    values(Splunk_Role) as Splunk_Role \
    latest(Splunk_Instance) as Splunk_Instance \
    latest(User) as User \
    latest(User_Length) as User_Length \
    values(Login_Source) as Login_Source \
    BY locator \
| eval Splunk_Role = mvsort(mvdedup(mvappend(Splunk_Role, Splunk_Role_KV))), Login_Source = mvsort(mvdedup(mvappend(Login_Source, Login_Source_KV))) \
| table locator User User_Length Earliest_Login_Updated Latest_Login_Updated Login_Source Splunk_Role Splunk_Instance \
| outputlookup splunk_sh_index_audit_user_login_kv_store_lookup key_field=locator \
| stats count

[splunk_sh_index_internal_scheduler_jobs_kv_store_lookup_load]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = 0
dispatchAs = user
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=scheduler search_group=dmc_group_search_head status=completed search_type!=datamodel_acceleration app!=splunk_archiver \
| fields _time host savedsearch_name app user scheduled_time priority dispatch_time window_time run_time result_count search_group \
| rename host as Splunk_Instance , savedsearch_name as Savedsearch_Name , app as App , user as User , scheduled_time as Scheduled_Time , priority as Priority, dispatch_time as Dispatch_Time, window_time as Window_Time , run_time as Run_Time, result_count as Result_Count \
| eval User = upper(User) , Splunk_Instance = upper(Splunk_Instance) \
| `get_splunk_env(Splunk_Instance)` \
| fields - search_group \
| eval locator=md5(Splunk_Role + Savedsearch_Name) \
| stats earliest(_time) as Earliest_Run_Time latest(_time) as Latest_Run_Time latest(*) as * by locator \
| table locator Splunk_Role Splunk_Instance Savedsearch_Name App User Scheduled_Time Priority Dispatch_Time Window_Time Earliest_Run_Time Latest_Run_Time Run_Time Result_Count \
| outputlookup splunk_sh_index_internal_scheduler_jobs_kv_store_lookup key_field=locator \
| stats count

[splunk_sh_index_internal_scheduler_jobs_kv_store_lookup_tracker]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = */5 * * * *
dispatch.earliest_time = -1s
dispatch.latest_time = now
display.events.fields = ["host","source","sourcetype","Splunk_Role"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=scheduler search_group=dmc_group_search_head status=completed search_type!=datamodel_acceleration app!=splunk_archiver earliest=-10m@m latest=-5m@m \
| fields _time host savedsearch_name app user scheduled_time priority dispatch_time window_time run_time result_count search_group \
| rename host as Splunk_Instance , savedsearch_name as Savedsearch_Name , app as App , user as User , scheduled_time as Scheduled_Time , priority as Priority, dispatch_time as Dispatch_Time, window_time as Window_Time , run_time as Run_Time, result_count as Result_Count \
| eval User = upper(User) , Splunk_Instance = upper(Splunk_Instance) \
| `get_splunk_env(Splunk_Instance)` \
| fields - search_group \
| eval locator=md5(Splunk_Role + Savedsearch_Name) \
| stats latest(_time) as Latest_Run_Time latest(*) as * by locator \
| table locator Splunk_Role Splunk_Instance Savedsearch_Name App User Scheduled_Time Priority Dispatch_Time Window_Time Latest_Run_Time Run_Time Result_Count \
| outputlookup splunk_sh_index_internal_scheduler_jobs_kv_store_lookup key_field=locator \
| stats count

[splunk_sh_rest_data_props_lookups_csv_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /servicesNS/-/-/data/props/lookups timeout=0 \
| rename eai:acl.* as * \
| `get_splunk_env(splunk_server)` \
| eval author = if(author="nobody", "SYSTEM", upper(author) ) , updated=if(match(updated, "^1969"), null(), updated) , updated=strptime(updated, "%Y-%m-%dT%H:%M:%S%z") , splunk_server = upper(splunk_server) \
| fields Splunk_Role splunk_server app sharing stanza title attribute transform overwrite value author updated \
| stats values(splunk_server) as splunk_server last(*) as * count by Splunk_Role app stanza attribute \
| table Splunk_Role splunk_server app sharing stanza attribute title transform overwrite value author updated \
| outputlookup splunk_sh_rest_data_props_lookups_csv_lookup createinapp=true create_empty=true append=false \
| stats count

[splunk_sh_rest_data_props_lookups_csv_lookup_report]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_data_props_lookups_csv_lookup \
| eval updated=strftime(updated,"%m/%d/%Y %H:%M:%S") \
| makemv delim=" " splunk_server \
| table Splunk_Role splunk_server app sharing stanza attribute title transform overwrite value author updated

[splunk_web_access_kv_store_lookup_load]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = Dashboard
display.statistics.format.0.scale = sharedCategory
display.statistics.format.1 = color
display.statistics.format.1.colorPalette = sharedList
display.statistics.format.1.field = locator
display.statistics.format.1.scale = sharedCategory
display.statistics.rowNumbers = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunk_web_access method=GET status=200 earliest=-10m@m latest=-5m@m \
    NOT view IN ("home" , "search" , "dashboard*", "alert*" , "check_alerts", "report*" , "field_extractor" , "job_manager" , "dataset*" , "pivot" , "show_source" , "charting" , "data_model*" , "flashtimeline" , "integrity_check_of_installed_files" , "licenseusage" , "live_tail" , "mod_setup" , "orphaned_scheduled_searches") \
    user!="-" \
| fields _time host search_group app view user \
| eval User = upper(trim(user)) , Splunk_Instance = trim(upper(host)) \
| `get_splunk_env(Splunk_Instance)` \
| eval locator=md5(Splunk_Role + view), All_Time=_time \
| stats \
    earliest(All_Time) as Earliest_Access\
    latest(All_Time) as Latest_Access\
    earliest(_time) as Earliest_Access_Updated\
    latest(_time) as Latest_Access_Updated\
    values(Splunk_Instance) as Splunk_Instance\
    values(User) as User\
    values(Splunk_Role) as Splunk_Role \
    values(app) as App \
    values(view) as Dashboard_Name \
    by locator \
| table locator Splunk_Role Splunk_Instance App Dashboard_Name User Earliest_Access Latest_Access Earliest_Access_Updated Latest_Access_Updated \
| outputlookup splunk_web_access_kv_store_lookup key_field=locator \
| stats count

[splunk_web_access_kv_store_lookup_tracker]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = */5 * * * *
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message","spent","view"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = Dashboard
display.statistics.format.0.scale = sharedCategory
display.statistics.format.1 = color
display.statistics.format.1.colorPalette = sharedList
display.statistics.format.1.field = locator
display.statistics.format.1.scale = sharedCategory
display.statistics.rowNumbers = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunk_web_access method=GET status=200\
    NOT view IN ("home" , "search" , "dashboard*", "alert*" , "check_alerts", "report*" , "field_extractor" , "job_manager" , "dataset*" , "pivot" , "show_source" , "charting" , "data_model*" , "flashtimeline" , "integrity_check_of_installed_files" , "licenseusage" , "live_tail" , "mod_setup" , "orphaned_scheduled_searches") \
    user!="-" earliest=-10m@m latest=-5m@m \
| fields _time host search_group app view user spent \
| eval User = upper(trim(user)) , Splunk_Instance = trim(upper(host)) \
| `get_splunk_env(Splunk_Instance)` \
| eval locator=md5(Splunk_Role + view) \
| stats \
    earliest(_time) as Earliest_Access_Updated\
    latest(_time) as Latest_Access_Updated\
    values(Splunk_Instance) as Splunk_Instance\
    values(User) as User\
    values(Splunk_Role) as Splunk_Role \
    values(app) as App \
    values(view) as Dashboard_Name \
    min(spent) as min_spent\
    max(spent) as max_spent\
    avg(spent) as avg_spent\
    by locator \
| eval avg_spent = round(avg_spent) \
| table locator Splunk_Role Splunk_Instance App Dashboard_Name User Earliest_Access_Updated Latest_Access_Updated min_spent max_spent avg_spent \
| outputlookup splunk_web_access_kv_store_lookup key_field=locator \
| stats count

[Duplicate Dashboards Report]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s
dispatch.latest_time = now
display.events.fields = ["host","source","sourcetype","BaseSearch","Search","Searches","active_searches","tag","phone","pii_phone","Phone","eventtype","pii_account","pii_email","pii_email_fixed","splunk_server","message","eaiApp","app","Aacl_app","form_App","form_app","form_application_index","app_only"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = Label
display.statistics.format.0.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup CCB_Splunk_SH_Dashboard_Analysis_Lookup_v1 \
| fields App App_Name Label Title Seal Index Author BaseSearch Updated Description Search \
| stats dc(App) as dc_App values(App) as App count by Label \
| where dc_App > 1

[Find_Duplicate_Lookup_Definitions_report]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = Lookup
display.statistics.format.0.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_admin_transforms-lookup_lookup \
| fields App Lookup Author App_Sharing Filename Type Collection Last_Updated Match_Type Min_Matches Max_Matches Fields_List \
| stats list(*) as * count as Duplicates by Lookup Filename \
| table Lookup Filename App Author App_Sharing Fields_List Last_Updated Duplicates \
| where Duplicates > 1

[LVDI3_Users_lookup_Gen]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["clientip","data.search_props.app","data.search_props.mode","data.search_props.sid","data.search_props.search_head","data.search_props.type","data.search_props.user","data.status","search","uri_path","search_id","info","user","sourcetype","Indexer_GUID","Indexer_Name","source","slave","stack","stacksz","subgroupId","type","guid","b","component","licenseGroup","licenseGuids","pool","poolsz"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = viz_clustermap.clustermap
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup LVDI3_Users_lookup \
`comment(" | table "Standard ID" "First Name" "Last Name" "LVDI Version" "AD Group Name" "User Domain" "Line of Business" "LOB Level 2" "LOB Level 3" "LOB Level 4" "Address 1" "Address 2" City State Country Region "VIP User" \
| rename "Standard ID" AS Standard_ID "First Name" AS First_Name "Last Name" AS Last_Name "LVDI Version" AS LVDI_Version "AD Group Name" AS AD_Group_Name "User Domain" AS User_Domain "Line of Business" AS LOB_Level_1 "LOB Level 2" AS LOB_Level_2 "LOB Level 3" AS LOB_Level_3 "LOB Level 4" AS LOB_Level_4 "Address 1" AS Address_1 "Address 2" AS Address_2 "VIP User" AS VIP_User \
| eval Standard_ID=upper(trim(Standard_ID)) \
| eval LOB=mvappend(LOB_Level_1, LOB_Level_2, LOB_Level_3, LOB_Level_4) , LVDI_Version = case ( match(LVDI_Version, "LVDI\s+8GB"), "LVDI_1", match(LVDI_Version, "LVDI\s+16GB"), "LVDI_2", match(LVDI_Version, "LVDI\s+3"), "LVDI_3", true(), LVDI_Version) \
| stats values(*) as * count by Standard_ID \
| eval LVDI_Version = mvjoin(LVDI_Version, "|") , AD_Group_Name = mvjoin(AD_Group_Name, "|") , LOB = mvjoin(LOB, "|") \
| outputlookup LVDI3_Users_lookup ")`\
| table Standard_ID count First_Name Last_Name LOB Address_1 Address_2 City State Country Region LVDI_Version AD_Group_Name User_Domain VIP_User \
| makemv delim="|" AD_Group_Name \
| makemv delim="|" LVDI_Version \
| makemv delim="|" LOB

[Lookups not used in any Dashboards or Reports/Alerts]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","sourcetype","event_message","log_level","index","search_group","splunk_server_group","group"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = area
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_admin_lookup-table-files_kv_store_lookup \
| lookup splunk_sh_rest_admin_transforms-lookup_lookup App AS App Filename AS Lookup_File App_Sharing AS App_Sharing Author AS Author OUTPUT Lookup Type \
| eval Type = if(match(Lookup_File,".csv"), "file", Type) , if(isnull(Lookup_File), "file", Type) , Lookup = if(isnull(Lookup), "NO-DEFINITION", Lookup) \
| eval Last_Updated = strftime(strptime(Last_Updated,"%Y-%m-%dT%H:%M:%S"),"%m/%d/%Y %H:%M:%S") \
| fillnull value="UNDEFINED" Type Lookup \
| lookup splunk_sh_rest_data_ui_dashboards_lookup Lookup_Reference as Lookup_File OUTPUT label as Dashboard_Name \
| lookup splunk_sh_rest_data_ui_dashboards_lookup Lookup_Reference as Lookup OUTPUTNEW label as Dashboard_Name \
| lookup shc_saved_searches_rest_kv_store_lookup Lookup_Reference as Lookup_File OUTPUT savedsearch_name \
| lookup shc_saved_searches_rest_kv_store_lookup Lookup_Reference as Lookup OUTPUTNEW savedsearch_name \
| where isnull(savedsearch_name) AND isnull(Dashboard_Name) \
| table Lookup_File Lookup Type App App_Sharing Author Last_Updated

[Max IOPS & Effective Storage]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1h@h
dispatch.latest_time = now
dispatchAs = user
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_monitoring_console
request.ui_dispatch_view = search
search = | rest splunk_server=* /services/server/status/partitions-space \
| join\
    type=outer splunk_server, mount_point \
    [| rest splunk_server=*\
        /services/server/status/resource-usage/iostats \
    | eval iops = round(reads_ps + writes_ps) \
    | fields splunk_server, mount_point, iops, cpu_pct] \
| eval free = if(isnotnull(available), available, free) \
| eval usage = round((capacity - free) / 1024, 2) \
| eval capacity = round(capacity / 1024, 2) \
| eval compare_usage = usage." / ".capacity \
| eval pct_usage = round(usage / capacity * 100, 2) \
| stats first(fs_type) as fs_type first(compare_usage) as compare_usage first(pct_usage) as pct_usage, first(iops) as iops, first(cpu_pct) as cpu_pct by mount_point \
| rename mount_point as "Mount Point", fs_type as "File System Type", compare_usage as "Disk Usage (GB)", capacity as "Capacity (GB)", pct_usage as "Disk Usage (%)", iops as "I/O operations per second", cpu_pct as "I/O Bandwidth Utilization(%)"

[Rajesh Duplicate Automatic Lookups to delete]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["host","source","sourcetype","app","file_name","file_size","log_level","event_message","index","accountAliasName","accountOrganizationCode","accountOrganizationCodeDescription","accountReferenceNumber","accountRelationshipStatus","accounts","accountStatusReasons","accountType","accountWithinSafeHarbourPeriod","cardRelatedDepositAccountIdentifier","creditAccountDetailsList","creditAccountList","debitAccountDetailsList","debitAccountList","digitalAccountIdentifier","isAccountInGoodStanding"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_data_props_lookups_csv_lookup \
| eval updated=strftime(updated,"%m/%d/%Y %H:%M:%S") \
| table Splunk_Role splunk_server app sharing stanza attribute title transform overwrite value author updated\
| table  app sharing stanza attribute title transform  value author\
| stats values(*) as * count by stanza attribute

[Rajesh Duplicate Dashboards]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["host","source","sourcetype","app","file_name","file_size","log_level","event_message","index","accountAliasName","accountOrganizationCode","accountOrganizationCodeDescription","accountReferenceNumber","accountRelationshipStatus","accounts","accountStatusReasons","accountType","accountWithinSafeHarbourPeriod","cardRelatedDepositAccountIdentifier","creditAccountDetailsList","creditAccountList","debitAccountDetailsList","debitAccountList","digitalAccountIdentifier","isAccountInGoodStanding"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_data_ui_dashboards_lookup \
| fields Splunk_Role splunk_server app sharing title label description type dashboard_size author location removable updated data Report_Reference Dashboard_Reference Lookup_Reference \
| rename Splunk_Role as Search_Head , title as Dashboard_Title, label as Dashboard_Name , updated as Dashboard_Last_Updated , app as App , location as Dashboard_Location, sharing as Dashboard_App_Sharing , description as Description, dashboard_size as Dashboard_Size \
| eval Author = case(author="NOBODY", "SYSTEM", true(), author) \
| stats list(App) as Apps dc(App) as Num_Apps list(Dashboard_Name) as Dashboard_Name list(Author) as Author list(Dashboard_App_Sharing) as Dashboard_App_Sharing by Dashboard_Title \
| table Dashboard_Title Dashboard_Name Author Apps Dashboard_App_Sharing Num_Apps

[Rajesh Duplicate Reports/Alerts]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["host","source","sourcetype","app","file_name","file_size","log_level","event_message","index","accountAliasName","accountOrganizationCode","accountOrganizationCodeDescription","accountReferenceNumber","accountRelationshipStatus","accounts","accountStatusReasons","accountType","accountWithinSafeHarbourPeriod","cardRelatedDepositAccountIdentifier","creditAccountDetailsList","creditAccountList","debitAccountDetailsList","debitAccountList","digitalAccountIdentifier","isAccountInGoodStanding"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup shc_saved_searches_rest_kv_store_lookup \
| fields app savedsearch_name description savedsearch_type sharing author owner updated disabled is_visible is_scheduled cron_schedule scheduled_times next_scheduled_time dc_scheduled_times auto_summarize dispatch_earliest_time dispatch_latest_time schedule_priority max_concurrent schedule_window allow_skew realtime_schedule alert_severity alert_track alert_type removable run_n_times run_on_startup splunk_server search \
| rename savedsearch_name as Name , description as Description , app as App, savedsearch_type as Type, sharing as App_Sharing, updated as Last_Updated, disabled as is_Disabled , is_visible as is_Visible, is_scheduled as is_Scheduled, cron_schedule as Cron_Schedule, next_scheduled_time as Next_Scheduled_Time, schedule_priority as Schedule_Priority, max_concurrent as Max_Concurrent, schedule_window as Schedule_Window, allow_skew as Allow_Skew, realtime_schedule as Realtime_Schedule , dispatch_earliest_time as Dispatch_Earliest_Time, dispatch_latest_time as Dispatch_Latest_Time \
| eval Author=upper(author) \
| stats list(App) as App list(App_Sharing) as App_Sharing list(Author) as Author dc(App) as Num_Apps by Name \
| where Num_Apps > 1

[Rajesh Lookup Files Duplicates]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["host","source","sourcetype","app","file_name","file_size","log_level","event_message","index","accountAliasName","accountOrganizationCode","accountOrganizationCodeDescription","accountReferenceNumber","accountRelationshipStatus","accounts","accountStatusReasons","accountType","accountWithinSafeHarbourPeriod","cardRelatedDepositAccountIdentifier","creditAccountDetailsList","creditAccountList","debitAccountDetailsList","debitAccountList","digitalAccountIdentifier","isAccountInGoodStanding"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_admin_lookup-table-files_kv_store_lookup \
| fields App Lookup_File App_Sharing Author Search_Head Count Disabled Last_Updated Lookup_File_Path \
| lookup splunk_sh_rest_admin_transforms-lookup_lookup App AS App Filename AS Lookup_File App_Sharing AS App_Sharing Author AS Author OUTPUT Lookup Type Match_Type Min_Matches Max_Matches Fields_List \
| eval Type = if(match(Lookup_File,".csv"), "file", Type) , if(isnull(Lookup_File), "file", Type) , Lookup = if(isnull(Lookup), "NO-DEFINITION", Lookup)\
| eval Last_Updated = strftime(strptime(Last_Updated,"%Y-%m-%dT%H:%M:%S"),"%m/%d/%Y %H:%M:%S")\
| fields App Lookup_File Lookup Type Match_Type Min_Matches Max_Matches Fields_List App_Sharing Author Search_Head Count Disabled Last_Updated Lookup_File_Path\
| fillnull value="UNDEFINED" Type Lookup\
| lookup splunk_sh_index_audit_user_login_kv_store_lookup User AS Author OUTPUT Latest_Login_Updated Login_Source Splunk_Role Splunk_Instance\
| eval Days_Since_Latest_Login = round((now() - Latest_Login_Updated) / 86400 ) \
| eval Latest_Login_Updated=strftime(Latest_Login_Updated,"%m/%d/%Y %H:%M:%S") \
| search App="*" AND Author=* AND App_Sharing=* AND Type="*" AND Lookup_File="***" AND Count < 13 NOT App IN ("Splunk_ML_Toolkit") |  fields App App_Sharing Lookup_File Lookup Author Lookup_File_Path \
| stats values(*) as * count as Duplicates by Lookup_File \
| eval Counter=1 \
| where Duplicates > 1 \
| eval #=1| table # Lookup_File Lookup App App_Sharing Author Lookup_File_Path Counter

[Rajesh Report on Duplicate Extractions]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_data_props_extractions_csv_lookup \
| eval updated=strftime(updated,"%m/%d/%Y %H:%M:%S") \
| table Splunk_Role splunk_server app sharing stanza title attribute transform overwrite value author type updated \
| makemv delim=" " splunk_server \
| table app sharing stanza attribute transform value author type updated \
| stats values(*) as * count by attribute value \
| table attribute value app sharing count type stanza author transform updated \
| sort - count \
| where count > 1

[Rajesh Report on Scheduled Reports/Alerts by Private users]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["host","source","sourcetype","app","file_name","file_size","log_level","event_message","index","accountAliasName","accountOrganizationCode","accountOrganizationCodeDescription","accountReferenceNumber","accountRelationshipStatus","accounts","accountStatusReasons","accountType","accountWithinSafeHarbourPeriod","cardRelatedDepositAccountIdentifier","creditAccountDetailsList","creditAccountList","debitAccountDetailsList","debitAccountList","digitalAccountIdentifier","isAccountInGoodStanding"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = Author
display.statistics.format.0.scale = sharedCategory
display.statistics.format.1 = color
display.statistics.format.1.colorPalette = sharedList
display.statistics.format.1.field = Author
display.statistics.format.1.scale = sharedCategory
display.statistics.format.2 = color
display.statistics.format.2.colorPalette = sharedList
display.statistics.format.2.field = Name
display.statistics.format.2.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup shc_saved_searches_rest_kv_store_lookup \
| fields app savedsearch_name description savedsearch_type sharing author owner updated disabled is_visible is_scheduled cron_schedule scheduled_times next_scheduled_time dc_scheduled_times auto_summarize dispatch_earliest_time dispatch_latest_time schedule_priority max_concurrent schedule_window allow_skew realtime_schedule alert_severity alert_track alert_type removable run_n_times run_on_startup splunk_server search \
| rename savedsearch_name as Name , description as Description , app as App, savedsearch_type as Type, sharing as App_Sharing, updated as Last_Updated, disabled as is_Disabled , is_visible as is_Visible, is_scheduled as is_Scheduled, cron_schedule as Cron_Schedule, next_scheduled_time as Next_Scheduled_Time, schedule_priority as Schedule_Priority, max_concurrent as Max_Concurrent, schedule_window as Schedule_Window, allow_skew as Allow_Skew, realtime_schedule as Realtime_Schedule , dispatch_earliest_time as Dispatch_Earliest_Time, dispatch_latest_time as Dispatch_Latest_Time \
| eval Author=upper(author) \
| lookup shc_splunk_audit_savedsearch_activity_kv_store_lookup App as App Savedsearch_Name AS Name OUTPUT Status Users Num_Users Latest_Result_Count Min_Result_Count Max_Result_Count Window_Time Earliest_Scheduled_Time Latest_Scheduled_Time Earliest_Dispatch_Time Latest_Dispatch_Time Latest_Dispatch_Time Lag_time Num_Runs Num_Search_Heads Search_Heads Total_Run_Time Min_Total_Run_Time Max_Total_Run_Time Med_Total_Run_Time Avg_Total_Run_Time \
| convert ctime(Earliest_Scheduled_Time) , ctime(Latest_Scheduled_Time) , ctime(Earliest_Dispatch_Time) , ctime(Latest_Dispatch_Time) \
| fields App Name is_Disabled is_Scheduled Type App_Sharing Author Dispatch_Earliest_Time Dispatch_Latest_Time Last_Updated Cron_Schedule Next_Scheduled_Time Schedule_Priority Max_Concurrent Schedule_Window Allow_Skew Realtime_Schedule Description Status Users Num_Users Latest_Result_Count Min_Result_Count,Max_Result_Count,Window_Time Earliest_Scheduled_Time Latest_Scheduled_Time Earliest_Dispatch_Time Latest_Dispatch_Time Latest_Dispatch_Time Lag_time Num_Runs Num_Search_Heads Search_Heads Total_Run_Time Min_Total_Run_Time Max_Total_Run_Time Med_Total_Run_Time Avg_Total_Run_Time \
| lookup splunk_sh_rest_data_ui_dashboards_lookup Report_Reference as Name OUTPUT Report_Reference \
| eval Report_Reference = if(isnull(Report_Reference), "NO_Report_Reference_Found", Report_Reference) \
| fillnull value=99999999 Max_Result_Count \
| eval Check_Result_Count = if("no" = "yes", 1, 999999999) \
| search App="*" AND Type=* AND Author=* AND is_Disabled=0 AND is_Scheduled=1 AND App_Sharing=user AND Report_Reference="*" \
| where Max_Result_Count < Check_Result_Count AND Max_Result_Count >= 0 \
| table App Name is_Disabled is_Scheduled Type Latest_Result_Count Min_Result_Count Max_Result_Count App_Sharing Author Report_Reference Dispatch_Earliest_Time Dispatch_Latest_Time Last_Updated Cron_Schedule Next_Scheduled_Time Schedule_Priority Max_Concurrent Schedule_Window Allow_Skew Realtime_Schedule Description Status Users Num_Users Window_Time Earliest_Scheduled_Time Latest_Scheduled_Time Earliest_Dispatch_Time Latest_Dispatch_Time Latest_Dispatch_Time Lag_time Num_Runs Num_Search_Heads Total_Run_Time Min_Total_Run_Time Max_Total_Run_Time Med_Total_Run_Time Avg_Total_Run_Time \
| lookup CCB_Splunk_SH_Users_Lookup_v1 user as Author OUTPUT name as Author_Name email as Author_Email roles as Author_Roles \
| rex field=Author_Name "(?<First_Name>^\w+)\s?(?<Middle_Name>\w+)?\s(?<Last_Name>\w+)" \
| eval First_Name = upper(substr(First_Name,1,1)).substr(First_Name,2) , Middle_Name = upper(Middle_Name) , Last_Name = upper(substr(Last_Name,1,1)).substr(Last_Name,2) \
| eval Author_Name = First_Name . " " . Middle_Name . "  " . Last_Name \
| table App Name Type Author Author_Name \
| stats values(*) as * count by Author Type\
| sort - count \
| table Author Author_Name App Name Type count

[Rajesh Report on all Extractions created by Users]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_data_props_extractions_csv_lookup \
| eval updated=strftime(updated,"%m/%d/%Y %H:%M:%S") \
| table Splunk_Role splunk_server app sharing stanza title attribute transform overwrite value author type updated \
| makemv delim=" " splunk_server \
| where Splunk_Role="PROD-SHC-1" AND author!="SYSTEM" AND author!="ADMIN" AND sharing="user" \
| table app author updated stanza attribute value\
| stats count by attribute

[Report on Config File Settings using REST]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","splunk_server_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest splunk_server=local /services/configs/conf-server/shclustering timeout=0 \
| fields - author eai:* updated published title pass4SymmKey encrypt_fields disabled splunk_server\
| fieldsummary \
| rex field=values "\[\{\"value\"\:\"(?<Setting_Value>.*?)\"" \
| rex field=Setting_Value "configs\/conf-(?<Config_File>\w+)\/(?<Stanza>\w+)" \
| rename field as Setting \
| eval Setting=if(Setting="id", "A_Fill_Down", Setting) \
| eval Setting_Value=case(Setting_Value=1,"True", Setting_Value=0,"False",true(), Setting_Value) \
| table Config_File Stanza Setting Setting_Value \
| sort Setting \
| filldown Config_File Stanza \
| eval Setting_Value=if(isnull(Setting_Value) OR Setting_Value="", null(), Setting_Value) \
| where Setting!="A_Fill_Down" AND isnotnull(Setting_Value)

[Report on Indexer License Master connection and read timeouts]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -72h@h
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["event_message","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4","Splunk_Env","Indexer_GUID","st","type","retry_timeout","request"]
display.general.type = visualizations
display.page.search.tab = visualizations
display.statistics.show = 0
display.visualizations.charting.chart = line
display.visualizations.charting.chart.nullValueMode = connect
display.visualizations.charting.chart.showDataLabels = all
display.visualizations.charting.chart.stackMode = stacked
display.visualizations.charting.legend.placement = bottom
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunkd log_level!=INFO component IN (LMTracker) \
| eval Reason = case ( \
    match(event_message, "Read Timeout"), "Read Timeout", \
    match(event_message, "Connect Timeout"), "Connection Timeout", \
    match(event_message, "Connection closed by peer"), "Connection closed by Indexer", \
    match(event_message, "Connection reset by peer"), "Connection reset by Indexer", \
    match(event_message, "Connection refused"), "Connection Refused", \
    match(event_message, "Name or service not known"), "Name or service not known", \
    match(event_message, "failed to send rows"), "failed to send rows", \
    true(), event_message) \
| search Reason IN ("Read Timeout", "Connection Timeout") \
| timechart count by Reason span=1h useother=false

[Report on Logged-In Users By SHC Member - Previous 24 Hours]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","source","host"]
display.general.type = visualizations
display.page.search.mode = fast
display.page.search.tab = visualizations
display.statistics.rowNumbers = 1
display.statistics.show = 0
display.visualizations.charting.chart.nullValueMode = connect
display.visualizations.charting.chart.showDataLabels = minmax
display.visualizations.charting.chart.stackMode = stacked100
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = splunk_monitoring_console.KpiTrafficLight
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_audit sourcetype=audittrail user=* "action=login attempt" action="success" \
| eval User = upper(trim(user)) , Splunk_Instance = trim(upper(dest)) , Login_Source = upper(src), User_Length=len(user) , locator=md5(lower(User)) , All_Time=_time \
| `get_splunk_env(Splunk_Instance)` \
| fields _time All_Time locator User User_Length Login_Source Splunk_Instance Splunk_Role \
| timechart count(User) as User BY Splunk_Instance span=1s useother=false fixedrange=false

[Report on all Splunk Configuration issues]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -30d@d
dispatch.latest_time = now
display.events.fields = ["app","file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = verbose
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = NUMBER
display.statistics.format.0.scale = sharedCategory
display.statistics.format.1 = number
display.statistics.format.1.field = Time_SEC
display.statistics.format.1.precision = 0
display.statistics.format.10 = color
display.statistics.format.10.colorPalette = minMidMax
display.statistics.format.10.colorPalette.maxColor = #1E93C6
display.statistics.format.10.colorPalette.minColor = #FFFFFF
display.statistics.format.10.field = Num_URIs
display.statistics.format.10.scale = minMidMax
display.statistics.format.11 = color
display.statistics.format.11.colorPalette = sharedList
display.statistics.format.11.field = Port
display.statistics.format.11.scale = sharedCategory
display.statistics.format.2 = color
display.statistics.format.2.colorPalette = sharedList
display.statistics.format.2.field = Reason
display.statistics.format.2.scale = sharedCategory
display.statistics.format.3 = color
display.statistics.format.3.colorPalette = sharedList
display.statistics.format.3.field = component
display.statistics.format.3.scale = sharedCategory
display.statistics.format.4 = color
display.statistics.format.4.colorPalette = list
display.statistics.format.4.colorPalette.colors = [#65A637,#F7BC38,#F58F39,#D93F3C]
display.statistics.format.4.field = Timeout_Seconds
display.statistics.format.4.scale = threshold
display.statistics.format.4.scale.thresholds = [0,10,100]
display.statistics.format.5 = color
display.statistics.format.5.colorPalette = sharedList
display.statistics.format.5.field = Component
display.statistics.format.5.scale = sharedCategory
display.statistics.format.6 = color
display.statistics.format.6.colorPalette = sharedList
display.statistics.format.6.field = Log_Level
display.statistics.format.6.scale = sharedCategory
display.statistics.format.7 = color
display.statistics.format.7.colorPalette = minMidMax
display.statistics.format.7.colorPalette.maxColor = #F2B827
display.statistics.format.7.colorPalette.midColor = #FFFFFF
display.statistics.format.7.colorPalette.minColor = #CC5068
display.statistics.format.7.field = Num_Messages
display.statistics.format.7.scale = minMidMax
display.statistics.format.7.scale.midType = percentile
display.statistics.format.7.scale.midValue = 50
display.statistics.format.8 = color
display.statistics.format.8.colorPalette = minMidMax
display.statistics.format.8.colorPalette.maxColor = #31A35F
display.statistics.format.8.colorPalette.midColor = #FFFFFF
display.statistics.format.8.colorPalette.minColor = #49443B
display.statistics.format.8.field = Num_IPs
display.statistics.format.8.scale = minMidMax
display.statistics.format.8.scale.midType = percentile
display.statistics.format.8.scale.midValue = 50
display.statistics.format.9 = color
display.statistics.format.9.colorPalette = sharedList
display.statistics.format.9.field = URI_Sample
display.statistics.format.9.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal "timeout" NOT message IN ("*File too small to check seekcrc*", "*HTTP client error in http pubsub Read*", "savedsearch_id=*", "delegate search job requested for savedsearch*", "*st=*timeout_s*", "*Insufficient permissions to read file*", "*status=delegated_remote, scheduled_time=*", "*status=delegated_remote_completion, scheduled_time=*", "*The maximum disk usage quota for this user*", "ENGINE: Error in*") \
| eval Reason=case(\
    match(message, "wallclock_ms"), "Consider a lower value of conf_replication_max_push_count in server.conf on all members", \
    match(message, "^A possible timestamp match"), "A possible timestamp match <NUMBER> is outside of the acceptable time window",\
    match(message, "^Current data throughput"), "Current data throughput (<NUMBER> kb/s) has reached maxKBps. As a result, data forwarding may be throttledf", \
    match(message, "^The TIME_FORMAT specified is matching timestamps"), "The TIME_FORMAT specified is matching timestamps <NUMBER> outside of the acceptable time window",\
    match(message, "^Error pulling configurations from captain"), "Error pulling configurations from captain",\
    match(message, "^The addPeer request from this member to the current captain"), "The addPeer request from this member to the current captain XXX failed", \
    match(message, "^quota enforcement for user="), "Quota enforcement for user=XXX, sid=XXX, elapsed_ms=YYY, cache_size=ZZZ took longer than AAA seconds",\
    match(message, "^Failed in pcre_exec"), "Failed in pcre_exec: Error PCRE_ERROR_MATCHLIMIT for regex: XXX, consider raising MATCH_LIMIT in props.conf or transforms.conf",\
    match(message, "^Synchronous bundle replication"), "Synchronous bundle replication succeeded; however it took too long" ,\
    match(message, "^Too many rows in result."), "Too many rows in result. Consider applying a skip and/or limit",\
    match(message, "^Dispatch Command:"), "Dispatch Command: The number of search artifacts in the dispatch directory is higher than recommended",\
    match(message, "^Requested argument count"), "Requested argument count exceeds the maxresultrows limit specified under restapi stanza in limits.conf",\
    match(message, "^An installed file"), "An installed file did not pass hash-checking due to reason",\
    match(message, "^Configuration from app"), "Configuration from app does not support reload",\
    match(message, "^Bundle upload error:"), "Bundle upload error: Connect to=https://XXX:8089 timed out",\
    match(message, "^Bundle validation failure"), "Bundle validation failure reported",\
    match(message, "^Connect to"), "Connect to=XXX:8089 timed out",\
    match(message, "^Reading reply to upload:"),"Reading reply to upload: rv=-2, Receive from=https://YYY:8089 timed out",\
    match(message, "^connection_timeout="), "Connection Timeout",\
    match(message, "^receive_timeout="), "Receive Timeout",\
    match(message, "^send_timeout="), "Send Timeout",\
    match(message, "^SSL session cache path"), "SSL session cache path enabled X session timeout",\
    match(message, "^Setting up input quiesce timeout for"), "Setting up input quiesce timeout",\
    match(message, "Error encountered for connection from"), "Error encountered for connection from src=<IP>. Read Timeout Timed out",\
    match(message, "^HTTP client error=Read Timeout while connecting to server"), "HTTP client error=Read Timeout",\
    match(message, "^Error checking for update"), "Error checking for update, URL=https://apps.splunk.com/api/apps:resolve/checkforupgrade: Connect Timeout",\
    match(message, "^Peer:https:"), "Peer:https://IP:8089  Unable to get server info from https://IP:8089/services/server/info due to: Connect Timeout",\
    match(message, "^Unable to get auth token from peer:"), "Unable to get auth token from peer: https://IP:8089 due to: Connect Timeout",\
    match(message, "^failed to send rows"), "Failed to send rows, reason='Unable to connect to license master=https://LM:8089 Error connecting: Connect Timeout",\
    match(message, "^select_for timeout hit waiting for read"), "Select_for timeout hit waiting for read",\
    match(message, "^Send failure while pushing PK to search peer"), "Send failure while pushing PK to search peer = https://IP:8089 , Connect Timeout",\
    match(message, "^Unable to get bundle list from peer:"), "Unable to get bundle list from peer: https://IP:8089 due to: Connect Timeout",\
    match(message, "^Aborting sync of search files after retry_timeout"), "Aborting sync of search files after retry_timeout",\
    match(message, "^Unable to messages from peer:"), "Unable to messages from peer: https://IP:8089 due to: Connect Timeou",\
    match(message, "^failed job=CMRollHotBucketJob"), "Failed job=CMRollHotBucketJob guid=XXX bid=INDEX transErr=Connect Timeout",\
    match(message, "^failed job=SHPDiscardJobs"), "Failed job=SHPDiscardJobs peer=IDX, guid=XXX aids_size=1 err=uri=https://IP:8089/services/shcluster/member/artifacts/foo/discard?output_mode=json, socket_error=Connect Timeout",\
    match(message, "^CONFIG: tools.sessions.timeout"), "CONFIG: tools.sessions.timeout",\
    match(message, "^CONFIG: response.timeout"), "CONFIG: response.timeout",\
    match(message, "^peer="), "peer=XXX peer_name=YYY transitioning from=Pending to=Down reason=heartbeat or restart timeout",\
    match(message, "^CONFIG: ui_inactivity_timeout"), "CONFIG: ui_inactivity_timeout>",\
    match(message, "^Connect timeout - waited for"), "Connect timeout - waited for <NUMBER> seconds. ip= port=8089",\
    match(message, "^Unable to get index list from peer"), "Unable to get index list from peer: https://<IP>:8089 due to: Connect Timeout",\
    match(message, "^Archive file="), "Archive file='XXX.gz' updated less than <NUMBER>ms ago, will not read it until it stops changing",\
    match(message, "^Forcing TcpOutputGroups"), "Forcing TcpOutputGroups to shutdown after timeout",\
    match(message, "^RAFT election timeout is"),"RAFT election timeout",\
    match(message, "^master sends new restart timeout="),"Master sends new restart timeout",\
    match(message, "^Write Timeout communicating with"),"Write Timeout communicating with <IP>, disconnecting",\
    match(message, "The maximum number of concurrent historical searches for this user"),"The maximum number of concurrent historical searches for this user   has been reached",\
    match(message, "^Read Timeout communicating"),"Read Timeout communicating",\
    match(message, "^Socket error from"),"Socket error while idling: Read Timeout",\
    match(message, "^Timeout$"),"Timeout",\
    match(message, "^failed appendEntriesRequest"),"Failed appendEntriesRequest err",\
    match(message, "^Error pushing configurations to captain"), "Error pushing configurations to captain",\
    match(message, "^Exception while processing request from for"), "Exception while processing request from for Replication Configuration",\
    match(message, "^Low Level http request failure"), "Low Level http request failure with Cluster Captain Artifacts",\
    `comment(" match(message, "^"),"", ")`\
    true(), "Other Issues"\
    ) \
    `comment("| where Reason="Other" ")` \
| rex field=message max_match=0 "(?<ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})" \
| rex field=message mode=sed "s/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}//g" \
| rex field=message max_match=0 "Timed\sout\safter\s(?<Timeout_Sec1>\d+)\s(seconds|secs)" \
| rex field=message max_match=0 "timeout=(?<Timeout_Sec2>\d+)" \
| rex field=message max_match=0 "(?<Timeout_Sec3>\d+)\s*(milliseconds|ms)" \
| rex field=message max_match=0 "timeout\s\(int\):\s(?<Timeout_Sec4>\d+)" \
| rex field=message max_match=0 "timeout\sfor\s:\s(?<Timeout_Sec5>\d+)" \
| rex field=message max_match=0 "waited\sfor\s(?<Timeout_Sec6>\d+)\.\d+\sseconds" \
| rex field=message max_match=0 "(?<Timeout_Sec7>\d+)\s(seconds|secs)" \
| eval Timeout_Sec3=Timeout_Sec3/1000 \
| eval Timeout_Sec=mvappend(Timeout_Sec1, Timeout_Sec2, Timeout_Sec3, Timeout_Sec4, Timeout_Sec5, Timeout_Sec6, Timeout_Sec7) \
| rex field=message max_match=0 "port(=|:)(?<Port>\d+)" \
| rex field=message max_match=0 ":(?<Port>8089)" \
| rex field=message max_match=0 "(?<NUMBER>\d+)\s" \
| rex field=message max_match=0 "https:\/\/(?<URI>.*?):" \
| eval Message_Trimmed=substr(message, 1, 200) \
| stats values(URI) as URI dc(URI) as Num_URIs values(Timeout_Sec) as Timeout_Seconds dc(Timeout_Sec) as Num_Time_SEC values(ip) as IP dc(ip) as Num_IPs values(Port) as Port values(component) as Component dc(component) as Num_components values(log_level) as Log_Level values(message) as Message values(Message_Trimmed) as Message_Trimmed count as Num_Messages by Reason \
| eval URI_Sample=mvindex(URI, 0, 2) , Message_Sample=mvindex(Message, 0, 2) , Message_Trimmed_Sample=mvindex(Message_Trimmed, 0, 2), IP_Sample=mvindex(IP, 0, 2) \
| eval Len_Reason=len(Reason) , Num_IPs=if(Num_IPs=0,null(),Num_IPs) , Num_URIs=if(Num_URIs=0,null(),Num_URIs) , Timeout_Seconds=if(Timeout_Seconds=0,null(),Timeout_Seconds) \
| table Reason Log_Level Component Num_Messages Timeout_Seconds IP_Sample Num_IPs URI_Sample Num_URIs Port Message_Trimmed_Sample Message_Sample

[Splunk SHC Concurrency Calculations]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -15m@m
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["search_type","search_type1","search_type2","savedsearch_id","sid","search_type_rex","alert_actions","app","status","scheduled_time","retry","user","member_guid","search_typex","alert_color","alert_level","alert_period","alert_severity","alert_value","search"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.totalsRow = 1
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = Splunk_ML_Toolkit.Scatter3dViz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /services/configs/conf-limits timeout=0 \
| search title IN (search, scheduler, typeahead, concurrency) \
| table splunk_server title base_max_searches max_searches_per_cpu max_searches_perc auto_summary_perc \
| sort max_searches_perc \
| filldown max_searches_perc \
| sort base_max_searches \
| filldown base_max_searches \
| sort max_searches_per_cpu \
| filldown max_searches_per_cpu \
| sort auto_summary_perc \
| filldown auto_summary_perc \
| eval number_of_cpus = 32 \
| eval splunk_server=upper(splunk_server) \
| eval max_searches_perc = if ( match(splunk_server, "IAASN00030686|IAASN00033501|IAASN00008920|IAASLN00001933|IAASN00041951"), 50, max_searches_perc) \
| eval max_hist_searches = (max_searches_per_cpu * number_of_cpus) + base_max_searches \
| eval max_hist_searches_cluster = 11 * max_hist_searches \
| eval max_hist_scheduled_searches = (max_hist_searches * max_searches_perc) / 100 \
| eval max_hist_scheduled_searches_cluster = 11 * max_hist_scheduled_searches \
| table splunk_server max_hist_scheduled_searches_cluster max_hist_searches_cluster max_hist_searches max_hist_scheduled_searches base_max_searches max_searches_per_cpu number_of_cpus max_searches_perc auto_summary_perc \
| dedup splunk_server

[Unused User Reports/Alerts To Archive]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup shc_saved_searches_rest_kv_store_lookup \
| fields app savedsearch_name description savedsearch_type sharing author owner updated disabled is_visible is_scheduled cron_schedule scheduled_times next_scheduled_time dc_scheduled_times auto_summarize dispatch_earliest_time dispatch_latest_time schedule_priority max_concurrent schedule_window allow_skew realtime_schedule alert_severity alert_track alert_type removable run_n_times run_on_startup splunk_server search Splunk_Role Lookup_Reference Datamodel_Reference \
| rename savedsearch_name as Name , description as Description , app as App, savedsearch_type as Type, sharing as App_Sharing, updated as Last_Updated, disabled as is_Disabled , is_visible as is_Visible, is_scheduled as is_Scheduled, cron_schedule as Cron_Schedule, next_scheduled_time as Next_Scheduled_Time, schedule_priority as Schedule_Priority, max_concurrent as Max_Concurrent, schedule_window as Schedule_Window, allow_skew as Allow_Skew, realtime_schedule as Realtime_Schedule , dispatch_earliest_time as Dispatch_Earliest_Time, dispatch_latest_time as Dispatch_Latest_Time \
| eval Author=upper(author) \
| lookup splunk_sh_index_internal_scheduler_jobs_kv_store_lookup Splunk_Role AS Splunk_Role App as App Savedsearch_Name AS Name OUTPUT Splunk_Instance User Scheduled_Time Priority Dispatch_Time Window_Time Latest_Run_Time Run_Time Result_Count \
| convert ctime(Scheduled_Time) , ctime(Dispatch_Time) , ctime(Latest_Run_Time) \
| fields App Name is_Disabled is_Scheduled Type App_Sharing Author Dispatch_Earliest_Time Dispatch_Latest_Time Last_Updated Cron_Schedule Next_Scheduled_Time Schedule_Priority Max_Concurrent Schedule_Window Allow_Skew Realtime_Schedule Description ,Window_Time Scheduled_Time Dispatch_Time Splunk_Role Splunk_Instance User Priority Latest_Run_Time Run_Time Result_Count splunk_server Lookup_Reference Datamodel_Reference search \
| lookup splunk_sh_rest_data_ui_dashboards_lookup Report_Reference as Name OUTPUT Report_Reference \
| eval Report_Reference = if(isnull(Report_Reference), "NO_Report_Reference_Found", Report_Reference) \
| lookup CCB_Splunk_SH_Users_Lookup_v1 user as Author OUTPUT name as Author_Name email as Author_Email roles as Author_Roles \
| rex field=Author_Name "(?<First_Name>^\w+)\s?(?<Middle_Name>\w+)?\s(?<Last_Name>\w+)" \
| eval First_Name = upper(substr(First_Name,1,1)).substr(First_Name,2) , Middle_Name = upper(Middle_Name) , Last_Name = upper(substr(Last_Name,1,1)).substr(Last_Name,2) \
| eval Author_Name = First_Name . " " . Middle_Name . " " . Last_Name \
| eval is_Disabled=case(is_Disabled=1, "Yes", is_Disabled=0, "No", true(), "other") \
| eval is_Scheduled=case(is_Scheduled=1, "Yes", is_Scheduled=0, "No", true(), "other") \
| fillnull value="Undefined" \
| where  Latest_Run_Time = "Undefined" \
| table App Name Type App_Sharing Author Author_Name search

[User Lookup File not used by any Dashboards/Reports/Alerts]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_admin_lookup-table-files_kv_store_lookup \
| fields App Lookup_File App_Sharing Author Search_Head Count Disabled Last_Updated Lookup_File_Path \
| lookup splunk_sh_rest_admin_transforms-lookup_lookup App AS App Filename AS Lookup_File App_Sharing AS App_Sharing Author AS Author OUTPUT Lookup Type Match_Type Min_Matches Max_Matches Fields_List \
| eval Type = if(match(Lookup_File,".csv"), "file", Type) , if(isnull(Lookup_File), "file", Type) , Lookup = if(isnull(Lookup), "NO-DEFINITION", Lookup) \
| eval Last_Updated = strftime(strptime(Last_Updated,"%Y-%m-%dT%H:%M:%S"),"%m/%d/%Y %H:%M:%S") \
| fields App Lookup_File Lookup Type Match_Type Min_Matches Max_Matches Fields_List App_Sharing Author Search_Head Count Disabled Last_Updated Lookup_File_Path \
| fillnull value="UNDEFINED" Type Lookup \
| lookup CCB_Splunk_SH_Users_Lookup_v1 user as Author OUTPUT name as Author_Name email as Author_Email roles as Author_Roles \
| rex field=Author_Name "(?<First_Name>^\w+)\s?(?<Middle_Name>\w+)?\s(?<Last_Name>\w+)" \
| eval First_Name = upper(substr(First_Name,1,1)).substr(First_Name,2) , Middle_Name = upper(Middle_Name) , Last_Name = upper(substr(Last_Name,1,1)).substr(Last_Name,2) \
| eval Author_Name = First_Name . " " . Middle_Name . " " . Last_Name \
| lookup splunk_sh_rest_data_ui_dashboards_lookup Lookup_Reference as Lookup_File OUTPUT title as Used_By_Dashboard \
| lookup splunk_sh_rest_data_ui_dashboards_lookup Lookup_Reference as Lookup OUTPUTNEW title as Used_By_Dashboard \
| lookup shc_saved_searches_rest_kv_store_lookup Lookup_Reference as Lookup_File OUTPUT savedsearch_name as Used_By_Report_Alert \
| lookup shc_saved_searches_rest_kv_store_lookup Lookup_Reference as Lookup OUTPUTNEW savedsearch_name as Used_By_Report_Alert \
| where App_Sharing = "user" AND isnull(Used_By_Dashboard) AND isnull(Used_By_Report_Alert) \
| table App Lookup_File Lookup Author Author_Name Last_Updated Lookup_File_Path

[User Report By Client IP/OS Name/OS Version/Browser Name/Browser Version]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -7d@h
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["user","file","info","dest","src","Vendor_Action","data.search_props.acceleration_id","data.search_props.label","data.search_props.mode","data.search_props.provenance","data.search_props.role","data.search_props.search_head","data.search_props.sid","data.search_props.type","data.status","data.search_props.user","mode","label","acceleration_id","app","process_type","provenance","role","search_head","type","datamodel","component","event_message","log_level","err","host"]
display.events.type = table
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = viz_clustermap.clustermap
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunkd_ui_access useragent=* status=200 user!="-" \
| eval user=upper(trim(user)) \
| rex field=useragent "(?<Browser_and_Version>(MSIE|Trident|(?!Gecko.+)Firefox|(?!AppleWebKit.+Chrome.+)Safari(?!.+Edge)|(?!AppleWebKit.+)Chrome(?!.+Edge)|(?!AppleWebKit.+Chrome.+Safari.+)Edge|AppleWebKit(?!.+Chrome|.+Safari)|Gecko(?!.+Firefox))(?: |\/)([\d\.apre]+)|Splunk.*?\s)" \
| rex field=useragent "(Version/|iPhone\sOS\s)(?<Safari_Version>.*?)\s" \
| rex field=Browser_and_Version "(?<Browser_Name>.*?)/" \
| rex field=Browser_and_Version "/(?<Browser_Version>.*?)$" \
| rex field=useragent "(?<Architecture>(Win64|x86_64))" \
| rex field=useragent "(?<OS_Name>(Linux|Macintosh|Windows\s*\w+|iPhone|iPad))" \
| rex field=useragent "(Linux\s|Macintosh;\s|i\w+;\s|Windows\sNT\s)(?<OS_Version>.*?)[;)]" \
| eval Browser_Version = if(isnotnull(Safari_Version), Safari_Version, Browser_Version) \
| eval clientip=if(clientip="147.107.200.10", "GTM", clientip) , \
    Browser_Name=if(Browser_Name="Trident", "Internet Explorer", Browser_Name), \
    OS_Name = case ( match(useragent,"Windows NT 6.1"), "Windows 7", match(useragent,"Windows NT 6.2"), "Windows 8", match(useragent,"Windows NT 6.3"), "Windows 8.1", match(useragent,"Windows NT 10.0"), "Windows 10", match(useragent,"Pixel"), "Google Pixel", match(useragent,"Android"), "Android", true(), OS_Name ) \
| fields clientip OS_Name OS_Version Browser_Name Browser_Version Architecture user \
    `comment("| lookup cim_http_status_lookup status OUTPUT status_action status_description status_type ")` \
| stats values(*) as * dc(clientip) as Num_clientip count by user  \
| table user OS_Name OS_Version clientip Num_clientip useragent Browser_Name Browser_Version Architecture Architecture count

[Users Dashboards to Archive]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["component","source","event_message","log_level","index","search_group","group","host","load_average","Time_Stamp","Time_Stamp_Bad1","Event_Size","sourcetype","Time_Stamp1","Time_Stamp2","Time_Stamp3","Time_Stamp4"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_data_ui_dashboards_lookup \
| fields Splunk_Role splunk_server app sharing title label description type dashboard_size author location removable updated data Report_Reference Dashboard_Reference Lookup_Reference Datamodel_Reference Search BaseSearch \
| rename Splunk_Role as Search_Head , title as Dashboard_Title, label as Dashboard_Name , updated as Dashboard_Last_Updated , app as App , location as Dashboard_Location, sharing as Dashboard_App_Sharing , description as Description, dashboard_size as Dashboard_Size\
| eval Days_Since_Last_Updated = round((now() - strptime(Dashboard_Last_Updated,"%m/%d/%Y %H:%M:%S")) / 86400 ) , Author=upper(author) \
| lookup CCB_Splunk_SH_Users_Lookup_v1 user as Author OUTPUT name as Author_Name email as Author_Email roles as Author_Roles \
| lookup splunk_web_access_kv_store_lookup Splunk_Role as Search_Head App as App Dashboard_Name as Dashboard_Title OUTPUT User Earliest_Access_Updated as Earliest_Dashboard_Access Latest_Access_Updated as Latest_Dashboard_Access\
| convert ctime(Earliest_Dashboard_Access) , ctime(Latest_Dashboard_Access) \
| rex field=Author_Name "(?<First_Name>^\w+)\s?(?<Middle_Name>\w+)?\s(?<Last_Name>\w+)" \
| eval First_Name = upper(substr(First_Name,1,1)).substr(First_Name,2) , Middle_Name = upper(Middle_Name) , Last_Name = upper(substr(Last_Name,1,1)).substr(Last_Name,2) \
| eval Author_Name = First_Name . " " . Middle_Name . " " . Last_Name \
| fillnull value=0 Days_Since_Last_Updated \
| fillnull value="Undefined"\
| eval Author = case(Author="NOBODY", "SYSTEM", true(), Author)\
| lookup splunk_sh_index_audit_user_login_kv_store_lookup User AS Author OUTPUT Latest_Login_Updated as User_Latest_Login Login_Source as User_Login_Source Splunk_Role as User_Role Splunk_Instance as User_Login_Splunk_Instance\
| eval Days_Since_Latest_Login = round((now() - User_Latest_Login) / 86400 ) \
| eval User_Latest_Login=strftime(User_Latest_Login,"%m/%d/%Y %H:%M:%S") \
| where Earliest_Dashboard_Access="Undefined"\
| table App Dashboard_App_Sharing Dashboard_Title Author Dashboard_Location

[splunk_env_indexer_guid_csv_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","source","host","peer","peer_name","component","Indexer_GUID","Indexer","Splunk_Env"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunkd component=CMPeer search_group=dmc_group_cluster_master earliest=-70m@m latest=-0m@m \
| rename peer as Indexer_GUID \
| eval Indexer_Name=upper(peer_name) \
| `get_splunk_env(Indexer_Name)` \
| rename Splunk_Role AS Splunk_Env \
| fields Splunk_Env Indexer_Name Indexer_GUID \
| stats count by Splunk_Env Indexer_Name Indexer_GUID \
| table Splunk_Env Indexer_Name Indexer_GUID \
| outputlookup splunk_env_indexer_guid_csv_lookup override_if_empty=true createinapp=true \
| stats count

[splunk_idx_audit_data_ingestion_kv_store_lookup_alert_splunk_env]
alert.expires = 1s
alert.suppress = 0
alert.track = 1
counttype = number of events
cron_schedule = 0 * * * *
dispatch.earliest_time = -1s
dispatch.latest_time = now
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","host","event_message","component","log_level","userName","username","source","current_size","current_size_kb","blocked","largest_size","max_size_kb","smallest_size","index","splunk_server"]
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
quantity = 0
relation = greater than
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_idx_audit_data_ingestion_kv_store_lookup \
| search NOT host IN ("AN*", "AH*") \
| eval Splunk_Instance=lower(host) \
| lookup dmc_assets host as Splunk_Instance OUTPUT search_group \
| where isnotnull(search_group) \
| eval Index_Time_Diff_Min = round((now() - Latest_Index_Time_Seen) / 60, 2) \
| eval Index_Time_Diff_Hours = round(Index_Time_Diff_Min / 60 , 2) \
| convert ctime(Earliest_Index_Time_Seen), ctime(Latest_Index_Time_Seen), ctime(Earliest_Time_Seen), ctime(Latest_Time_Seen) \
| table host search_group index sourcetype source Earliest_Index_Time_Seen Latest_Index_Time_Seen Index_Time_Diff_Min Index_Time_Diff_Hours \
| where Index_Time_Diff_Min > 15

[splunk_idx_audit_data_ingestion_kv_store_lookup_load]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -4h@h
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","host","event_message","component","log_level","userName","username","source","current_size","current_size_kb","blocked","largest_size","max_size_kb","smallest_size","index","splunk_server"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = number
display.statistics.format.0.field = count
display.statistics.format.0.precision = 0
display.statistics.format.1 = number
display.statistics.format.1.field = count
display.statistics.format.1.precision = 0
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | tstats \
    min(_indextime) as Earliest_Index_Time_Seen\
    max(_indextime) as Latest_Index_Time_Seen\
    min(_time) as Earliest_Time_Seen\
    max(_time) as Latest_Time_Seen\
    where \
    index IN (_*, *) NOT index IN (_audit, _introspection)\
    NOT host IN ("127.*","10.*","168.*","172.*","169.*","155.*","pod","ah*","an*")\
    NOT sourcetype IN ("*-too_small", "stash", "*/splunkd*", "*-1","*_0","*_1","*_2","*_3","*_4","*_5","*_6","*_7","*_8","*_9")\
    NOT source IN ("*.log.*", "/opt/splunk*/var/run/splunk/*")\
    AND splunk_server IN (bel1-splk-idx10,bel1-splk-idx11,bel1-splk-idx12,bel1-splk-idx13,bel1-splk-indx1,bel1-splk-indx2,bel1-splk-indx3,bel1-splk-indx4,bel1-splk-indx5,bel1-splk-indx6,bel1-splk-indx7,bel1-splk-indx8,bel1-splk-indx9,cdc1-splk-idx10,cdc1-splk-idx11,cdc1-splk-idx12,cdc1-splk-idx13,cdc1-splk-indx1,cdc1-splk-indx2,cdc1-splk-indx3,cdc1-splk-indx4,cdc1-splk-indx5,cdc1-splk-indx6,cdc1-splk-indx7,cdc1-splk-indx8,cdc1-splk-indx9,crl-splnk-idx10,crl-splnk-idx11,crl-splnk-idx12,crl-splnk-idx13,crl-splnk-indx1,crl-splnk-indx2,crl-splnk-indx3,crl-splnk-indx4,crl-splnk-indx5,crl-splnk-indx6,crl-splnk-indx7,crl-splnk-indx8,crl-splnk-indx9,icpbell00044,icpbelv00228,icpbelv00229,icpbelv00230,icpbelv00231,icpbelv00232,icpbelv00233,icpbelv00235,icpbelv00236,icpbelv00237,icpbelv00238,icpbelv00239,icpbelv00240,icpbelv00242,icpbelv00243,icpbelv00244,icpbelv00412,icpbelv00413,icpbelv00414,icpbelv00415,icpcarl01001,icpcarl01035,icpcarl01036,icpcarl01037,icpcarl01038,icpcarl01039,icpcarl01040,icpcarl01041,icpcarl01042,icpcarl01043,icpcarl01057,icpcarl01059,icpcarl01060,icpcarl01062,icpcarl01063,icpcarl01064,icpcarl01065,icpcarl01066,icpcarl01067,icpcarl01068,icpcdc100036,icpcdc100037,icpcdc100038,icpcdc100039,icpcdc100040,icpcdc100041,icpcdc100042,icpcdc100043,icpcdc100047,icpcdc100057,icpcdc100059,icpcdc100060,icpcdc100061,icpcdc100069,icpcdc100070,icpcdc100071,icpcdc100072,icpcdc100073,icpcdc100074,icpcdc100075)\
    by host index sourcetype source \
| eval host = upper(host) \
| rex field=host mode=sed "s/\..*$//g" \
| eval locator = md5(lower(host + index + sourcetype + source)) \
| stats \
    min(Earliest_Index_Time_Seen) as Earliest_Index_Time_Seen\
    max(Latest_Index_Time_Seen) as Latest_Index_Time_Seen\
    min(Earliest_Time_Seen) as Earliest_Time_Seen\
    max(Latest_Time_Seen) as Latest_Time_Seen\
    last(host) as host\
    last(index) as index\
    last(sourcetype) as sourcetype\
    last(source) as source\
    by locator \
| table locator host index sourcetype source Earliest_Index_Time_Seen Latest_Index_Time_Seen Earliest_Time_Seen Latest_Time_Seen \
| outputlookup splunk_idx_audit_data_ingestion_kv_store_lookup key_field=locator createinapp=true \
| stats count

[splunk_sh_dm_audit_savedsearch_activity_kv_store_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 1 * * *
dispatch.earliest_time = 0
display.events.fields = ["host","source","sourcetype","splunk_server_group","component","log_level","message","search_group","index","Index_Name","Source_Name","Sourcetype_Name","uri","file","search"]
display.general.timeRangePicker.show = 0
display.page.search.mode = fast
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | tstats SUMMARIESONLY=TRUE ALLOW_OLD_SUMMARIES=TRUE \
    count AS Num_Runs\
    values(Splunk_Server.Scheduler.User) AS Users\
    values(host) AS Search_Heads\
    dc(host) AS Num_Search_Heads\
    dc(Splunk_Server.Scheduler.User) AS Num_Users\
    latest(Splunk_Server.Scheduler.Total_Run_Time) AS Total_Run_Time\
    max(Splunk_Server.Scheduler.Total_Run_Time) AS Max_Total_Run_Time\
    min(Splunk_Server.Scheduler.Total_Run_Time) AS Min_Total_Run_Time\
    avg(Splunk_Server.Scheduler.Total_Run_Time) AS Avg_Total_Run_Time\
    median(Splunk_Server.Scheduler.Total_Run_Time) AS Med_Total_Run_Time\
    earliest(Splunk_Server.Scheduler.Dispatch_Time) AS Earliest_Dispatch_Time\
    latest(Splunk_Server.Scheduler.Dispatch_Time) AS Latest_Dispatch_Time\
    earliest(Splunk_Server.Scheduler.Scheduled_Time) AS Earliest_Scheduled_Time\
    latest(Splunk_Server.Scheduler.Scheduled_Time) AS Latest_Scheduled_Time\
    latest(Splunk_Server.Scheduler.Window_Time) AS Window_Time\
    latest(Splunk_Server.Scheduler.Result_Count) AS Latest_Result_Count\
    min(Splunk_Server.Scheduler.Result_Count) AS Min_Result_Count\
    max(Splunk_Server.Scheduler.Result_Count) AS Max_Result_Count\
    latest(Splunk_Server.Scheduler.Status) AS Status\
    FROM DATAMODEL=Splunk_Monitoring\
    WHERE nodename=Splunk_Server.Scheduler\
    AND Splunk_Server.Scheduler.Status = "completed"\
    AND Splunk_Server.Scheduler.App!="splunk_archiver"\
    BY Splunk_Server.Scheduler.App Splunk_Server.Scheduler.Savedsearch_Name \
| rename "Splunk_Server.Scheduler.*" AS "*" \
| eval Search_Heads=upper(Search_Heads) \
| eval Min_Total_Run_Time=round(Min_Total_Run_Time, 2), Max_Total_Run_Time=round(Max_Total_Run_Time, 2), Avg_Total_Run_Time=round(Avg_Total_Run_Time, 2), Med_Total_Run_Time=round(Med_Total_Run_Time, 2) , Total_Run_Time=round(Total_Run_Time, 2) \
| eval Lag_time = round ( (Latest_Dispatch_Time - Latest_Scheduled_Time), 2) \
| table App Savedsearch_Name Status Users Num_Users Latest_Result_Count Min_Result_Count Max_Result_Count Window_Time Earliest_Scheduled_Time Latest_Scheduled_Time Earliest_Dispatch_Time Latest_Dispatch_Time Latest_Dispatch_Time Lag_time Num_Runs Num_Search_Heads Search_Heads Total_Run_Time Min_Total_Run_Time Max_Total_Run_Time Med_Total_Run_Time Avg_Total_Run_Time \
| outputlookup shc_splunk_audit_savedsearch_activity_kv_store_lookup createinapp=true create_empty=true append=false \
| stats count

[splunk_sh_index_audit_user_login_kv_store_lookup_load]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = 0
display.events.fields = ["index","source","sourcetype","component","user","file","action","info","app","dest","src","Vendor_Action","Search_Head","Splunk_Role","Splunk_Instance","MC_Search_Group"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = User
display.statistics.format.0.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_audit sourcetype=audittrail user=* "action=login attempt" action="success" \
| eval User = upper(trim(user)) , Splunk_Instance = trim(upper(dest)) , Login_Source = upper(src), User_Length=len(user) , locator=md5(lower(User)) , All_Time=_time \
| `get_splunk_env(Splunk_Instance)` \
| fields _time All_Time locator User User_Length Login_Source Splunk_Instance Splunk_Role \
| stats \
    earliest(All_Time) as Earliest_Login \
    latest(All_Time) as Latest_Login \
    earliest(_time) as Earliest_Login_Updated \
    latest(_time) as Latest_Login_Updated \
    latest(Splunk_Role) as Splunk_Role \
    latest(Splunk_Instance) as Splunk_Instance \
    latest(User) as User \
    latest(User_Length) as User_Length \
    latest(Login_Source) as Login_Source \
    BY locator \
| table locator User User_Length Earliest_Login Latest_Login Earliest_Login_Updated Latest_Login_Updated Login_Source Splunk_Role Splunk_Instance \
| outputlookup splunk_sh_index_audit_user_login_kv_store_lookup key_field=locator \
| stats count

[splunk_sh_index_audit_user_login_kv_store_lookup_report]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = []
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_index_audit_user_login_kv_store_lookup \
| eval Days_Since_Latest_Login = round((now() - Latest_Login_Updated) / 86400 ) , Days_Since_Earliest_Login = round((now() - Earliest_Login_Updated) / 86400 ) \
| eval Earliest_Login=strftime(Earliest_Login,"%m/%d/%Y %H:%M:%S") , Latest_Login=strftime(Latest_Login,"%m/%d/%Y %H:%M:%S") , Earliest_Login_Updated=strftime(Earliest_Login_Updated,"%m/%d/%Y %H:%M:%S"), Latest_Login_Updated=strftime(Latest_Login_Updated,"%m/%d/%Y %H:%M:%S") \
| table User User_Length Earliest_Login Latest_Login Earliest_Login_Updated Latest_Login_Updated Days_Since_Earliest_Login Days_Since_Latest_Login Login_Source Splunk_Role Splunk_Instance\
| where Days_Since_Latest_Login >= 0

[splunk_sh_lookup_dashboard_analysis_apps_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 3 * * *
dispatch.earliest_time = -1s
dispatch.latest_time = now
display.events.fields = ["host","source","sourcetype","BaseSearch","Search","Searches","active_searches","tag","phone","pii_phone","Phone","eventtype","pii_account","pii_email","pii_email_fixed","splunk_server","message","eaiApp","app","Aacl_app","form_App","form_app","form_application_index","app_only","user"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup CCB_Splunk_SH_Dashboard_Analysis_Lookup_v1 \
| search NOT App IN ("Splunk_*", "splunk-app*", "*_app*", "system") \
| stats count by App \
| table App \
| sort 0 App \
| outputlookup CCB_Splunk_SH_Dashboard_Analysis_Apps_Lookup_v1.csv createinapp=true create_empty=true append=false\
| stats count

[splunk_sh_rest_admin_lookup-table-files_kv_store_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 4 * * *
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
display.events.fields = ["Index_Name","Source_Name","Sourcetype_Name","uri","file","search","App","Saved_Search_App","search_id","Saved_Search_App2","priority","window_time","User","Savedsearch_Name","reason","Status","Scheduled_Time","Search_Type","message","Dispatch_Time","Total_Run_Time","Result_Count","Member_Label","alert_actions","Search_Type2","search_type","Search_Type3","Search_Type1"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = Lookup_File
display.statistics.format.0.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /servicesNS/-/-/admin/lookup-table-files timeout=0 \
| rename eai:acl.* as * , eai:* as * \
| rename appName as App, title as Lookup_File, author as Author, disabled as Disabled, sharing as App_Sharing, splunk_server as Search_Head, updated as Last_Updated data as Lookup_File_Path \
| eval Author = upper(Author) , Search_Head = upper(Search_Head) \
| eval Author = if(Author="NOBODY", "SYSTEM", Author) , Last_Updated=if(match(Last_Updated, "^1969"), null(), Last_Updated) \
| fields Lookup_File Author Disabled App App_Sharing Search_Head Last_Updated Lookup_File_Path \
| stats last(*) as * values(Search_Head) as Search_Head values(Author) as Author dc(Search_Head) as Count by App Lookup_File App_Sharing \
| table App Lookup_File App_Sharing Author Search_Head Count Disabled Last_Updated Lookup_File_Path \
| outputlookup splunk_sh_rest_admin_lookup-table-files_kv_store_lookup createinapp=true create_empty=true append=false \
| stats count

[splunk_sh_rest_admin_transforms-lookup_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 5 * * *
description = splunk_sh_rest_admin_transforms-lookup_lookup REST Job
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
display.events.fields = ["Index_Name","Source_Name","Sourcetype_Name","uri","file","search","App","Saved_Search_App","search_id","Saved_Search_App2","priority","window_time","User","Savedsearch_Name","reason","Status","Scheduled_Time","Search_Type","message","Dispatch_Time","Total_Run_Time","Result_Count","Member_Label","alert_actions","Search_Type2","search_type","Search_Type3","Search_Type1"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = color
display.statistics.format.0.colorPalette = sharedList
display.statistics.format.0.field = Lookup
display.statistics.format.0.scale = sharedCategory
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest timeout=0 /servicesNS/-/-/admin/transforms-lookup \
    `comment("splunk_server=iaasln00001933 splunk_server_group=dmc_group_search_head splunk_server_group="dmc_customgroup_ccb_search_head_cluster"")` \
| rename eai:acl.* as * , eai:* as * \
| rename appName as App, title as Lookup, author as Author, disabled as Disabled, sharing as App_Sharing, splunk_server as Search_Head, updated as Last_Updated data as Lookup_File_Path, filename as Filename fields_list as Fields_List type as Type match_type as Match_Type replicate as Replicate allow_caching as Allow_Caching collection as Collection filter as Filter index_fields_list as Index_Fields_List min_matches as Min_Matches max_matches as Max_Matches \
| eval Author = upper(Author) , Last_Updated=if(match(Last_Updated, "^1969"), null(), Last_Updated) \
| eval Author = if(Author="NOBODY", "SYSTEM", Author) \
| fields App App_Sharing Lookup Filename Type Collection Last_Updated Disabled Author Match_Type Replicate Allow_Caching Filter Index_Fields_List Min_Matches Max_Matches Fields_List \
| stats last(*) as * count as Count by App Lookup App_Sharing Author \
| table App Lookup Author App_Sharing Filename Type Collection Last_Updated Disabled Match_Type Replicate Allow_Caching Filter Index_Fields_List Min_Matches Max_Matches Fields_List \
| outputlookup splunk_sh_rest_admin_transforms-lookup_lookup createinapp=true create_empty=true append=false \
| stats count

[splunk_sh_rest_authentication_users_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 6 * * *
dispatch.earliest_time = -1s
dispatch.latest_time = now
display.events.fields = ["host","source","sourcetype","action","elapsedTime","remote_ttl","user","active_searches","index","server","search_id","kb","src_ip","ip","clientip","view","app","Browser"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /servicesNS/-/-/authentication/users\
| eval user=upper(trim(title)) , name=lower(trim(email)) \
| rex field=name mode=sed "s/@.*//g" \
| rex field=name mode=sed "s/\./ /g" \
| fields user name email capabilities defaultApp roles type \
| stats values(*) as * by user \
| table user type name email roles defaultApp capabilities\
| outputlookup CCB_Splunk_SH_Users_Lookup_v1 createinapp=true create_empty=true append=false\
| stats count

[splunk_sh_rest_configs_conf-props_lookup_gen]
action.email.include.search = 1
action.email.inline = 1
action.email.sendresults = 1
action.email.to = amir.khamis@chase.com
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 18 * * *
dispatch.earliest_time = -1s
dispatch.latest_time = now
display.events.fields = ["source","BaseSearch","Search","Searches","active_searches","phone","pii_phone","Phone","pii_account","pii_email","pii_email_fixed","splunk_server","eaiApp","app","Aacl_app","form_App","form_app","form_application_index","app_only","user","run_time","status","success","dispatch_time","digest_mode","savedsearch_name","savedsearch_id","suppressed","window_time","concurrency_category","concurrency_context","concurrency_limit","reason","priority","member_label","scheduled_time","search_type","skipped"]
display.events.type = table
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /servicesNS/-/-/configs/conf-props timeout=0\
| rename eai:* as * \
| search NOT appName IN (Splunk_SA_CIM, bloodhound, splunk_global_monitoring_console, fire_brigade, learned, lookup_editor, search, splunk-ps-technical-assessment, splunk_archiver, splunk_instrumentation, splunk_monitoring_console, system) \
| fields title appName description TIME_PREFIX TIME_FORMAT MAX_TIMESTAMP_LOOKAHEAD DATETIME_CONFIG SHOULD_LINEMERGE LINE_BREAKER TRUNCATE BREAK_ONLY_BEFORE BREAK_ONLY_BEFORE_DATE MUST_BREAK_AFTER KV_MODE INDEXED_EXTRACTIONS EVENT_BREAKER_ENABLE EVENT_BREAKER ANNOTATE_PUNCT LEARN_SOURCETYPE LEARN_MODEL MAX_EVENTS maxDist \
| stats last(*) as * BY appName title\
| outputlookup shc_configs_conf-props_rest_lookup create_empty=false createinapp=true\
| stats count

[splunk_sh_rest_data_props_calcfields_csv_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /servicesNS/-/-/data/props/calcfields timeout=0 \
| rename eai:acl.* as *, field.* as * \
| `get_splunk_env(splunk_server)` \
| eval author = if(author="nobody", "SYSTEM", upper(author) ) , updated=if(match(updated, "^1969"), null(), updated) , updated=strptime(updated, "%Y-%m-%dT%H:%M:%S%z") , splunk_server = upper(splunk_server) \
| fields Splunk_Role splunk_server app sharing stanza name value title attribute author updated \
| stats values(splunk_server) as splunk_server last(*) as * count by Splunk_Role app stanza attribute \
| table Splunk_Role splunk_server app sharing stanza name value title attribute author updated \
| outputlookup splunk_sh_rest_data_props_calcfields_csv_lookup createinapp=true create_empty=true append=false \
| stats count

[splunk_sh_rest_data_props_calcfields_csv_lookup_report]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_data_props_calcfields_csv_lookup \
| eval updated=strftime(updated,"%m/%d/%Y %H:%M:%S") \
| makemv delim=" " splunk_server \
| table Splunk_Role splunk_server app sharing stanza name value title attribute author updated

[splunk_sh_rest_data_props_extractions_csv_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /servicesNS/-/-/data/props/extractions timeout=0 \
| rename eai:acl.* as * \
| `get_splunk_env(splunk_server)` \
| eval author = if(author="nobody", "SYSTEM", upper(author) ) , updated=if(match(updated, "^1969"), null(), updated) , updated=strptime(updated, "%Y-%m-%dT%H:%M:%S%z") , splunk_server = upper(splunk_server) \
| fields Splunk_Role splunk_server app sharing stanza title attribute transform overwrite value author type updated \
| stats values(splunk_server) as splunk_server last(*) as * count by Splunk_Role app stanza attribute \
| table Splunk_Role splunk_server app sharing stanza title attribute transform overwrite value author type updated \
| outputlookup splunk_sh_rest_data_props_extractions_csv_lookup createinapp=true create_empty=true append=false \
| stats count

[splunk_sh_rest_data_props_extractions_csv_lookup_report]
action.email.useNSSubject = 1
alert.track = 0
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["file_name","file_size","user","sourcetype","component","host","index","log_level","message","search_group","splunk_server_group","Splunk_Role","hostname","splunk_server","event_message"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.wrap = 0
display.visualizations.charting.chart = line
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = number_display_viz.number_display_viz
display.visualizations.show = 0
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | inputlookup splunk_sh_rest_data_props_extractions_csv_lookup \
| eval updated=strftime(updated,"%m/%d/%Y %H:%M:%S") \
| table Splunk_Role splunk_server app sharing stanza title attribute transform overwrite value author type updated \
| makemv delim=" " splunk_server

[splunk_sh_rest_data_ui_dashboards_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 19 * * *
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
display.events.fields = ["host","source","sourcetype","splunk_server_group"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /servicesNS/-/-/data/ui/views timeout=0 search="isDashboard=1" search="isVisible=1" search="disabled=0" search="eai:acl.app!=system" \
| search NOT title IN ("about", "home" , "search" , "dashboard*", "alert*" , "check_alerts", "report*" , "field_extractor" , "job_manager" , "dataset*" , "pivot" , "show_source" , "charting" , "data_model*" , "flashtimeline" , "integrity_check_of_installed_files" , "licenseusage" , "live_tail" , "mod_setup" , "orphaned_scheduled_searches", "setup", "sample_*") \
| rename eai:* as * \
| rename acl.* as * \
| fields splunk_server app sharing title label description type author removable updated data id \
| eval dashboard_size = len(data) , author=upper(author) \
| rex field=id mode=sed "s/^https:\/\/127.0.0.1:8089\/servicesNS\///g" \
| rex field=id mode=sed "s/^nobody/apps/g" \
| eval location=if(match(id, "^apps"), id, "users/" . id) \
| rex field=data max_match=0 "<search ref=\"(?<Report_Reference>\w+)\"></search>" \
| rex field=data max_match=0 "href=\"(?<Dashboard_Reference>\w+)\">" \
| rex field=data max_match=0 "\|\s*lookup\s*(?<Lookup_Reference1>\w+)" \
| rex field=data max_match=0 "\|\s*inputlookup\s*(?<Lookup_Reference2>\w+)" \
| eval Lookup_Reference=mvsort(mvdedup(mvappend(Lookup_Reference1, Lookup_Reference2))) \
| rex field=data max_match=0 "<query>(?<query>\p{Any}+?)<\/query>" \
| rex field=data max_match=0 "<param name=\"search\">(?<param>\p{Any}+?)<\/param>" \
| rex field=data max_match=0 "<searchString>(?<searchString>\p{Any}+?)<\/searchString>" \
| rex field=data max_match=0 "[<]search\s(base|id)=\"(?<base1>\w+)" \
| rex field=data max_match=0 "[<]search\sdepends=.*id=\"(?<base2>\w+)" \
| eval base=mvsort(mvdedup(mvappend(base1, base2))) \
| eval BaseSearch = IF(isnull(base), "NONE", base) \
| eval Search=trim(mvsort(mvdedup(mvappend(query, param, searchString)))) \
| rex field=Search mode=sed "s/\s{2,}/ /g" \
| rex field=Search mode=sed "s/\&lt;=/<=/g" \
| rex field=Search mode=sed "s/\&gt;=/>=/g" \
| rex field=Search mode=sed "s/\&lt;/</g" \
| rex field=Search mode=sed "s/\&gt;/>/g" \
| eval Search =if ( match(Search, "^\s+$") OR Search="", null(), Search ) \
| rex field=Search mode=sed "s/^\s*[\r\n]+//g" \
| rex field=Search max_match=0 "[fF][rR][oO][mM]\s*[dD][aA][tT][aA][mM][oO][dD][eE][lL]\s*=\s*\"?(?<Datamodel_Reference>.*?)\"?\s" \
| eval Datamodel_Reference=mvdedup(Datamodel_Reference) \
| `get_splunk_env(splunk_server)` \
| eval splunk_server=upper(splunk_server) \
| fields Splunk_Role splunk_server app sharing title label description type dashboard_size author location removable updated Report_Reference Dashboard_Reference Lookup_Reference Datamodel_Reference Search BaseSearch \
| stats values(splunk_server) as splunk_server values(Report_Reference) as Report_Reference values(Dashboard_Reference) as Dashboard_Reference values(Lookup_Reference) as Lookup_Reference values(Datamodel_Reference) as Datamodel_Reference values(Search) as Search values(BaseSearch) as BaseSearch last(*) as * by Splunk_Role app title \
| table Splunk_Role splunk_server app sharing title label description type dashboard_size author location removable updated data Report_Reference Dashboard_Reference Lookup_Reference Datamodel_Reference Search BaseSearch \
| outputlookup splunk_sh_rest_data_ui_dashboards_lookup createinapp=true create_empty=true append=false \
| stats count

[splunk_sh_rest_data_ui_views_dashboard_analysis_lookup_gen]
action.email.inline = 1
action.email.sendresults = 1
action.email.to = amir.khamis@chase.com
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 20 * * *
dispatch.earliest_time = -1s
dispatch.latest_time = now
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /servicesNS/-/-/data/ui/views timeout=0 search="isDashboard=1" search="disabled=0" \
| rename eai:data as data eai:appName as app \
| where isDashboard=1 \
| rex field=data max_match=0 "<query>(?<query>\p{Any}+?)<\/query>" \
| rex field=data max_match=0 "<param name=\"search\">(?<param>\p{Any}+?)<\/param>" \
| rex field=data max_match=0 "<query>(?<query>\p{Any}+?)<\/query>" \
| rex field=data max_match=0 "[<]search\s(base|id)=\"(?<base1>\w+)" \
| rex field=data max_match=0 "[<]search\sdepends=.*id=\"(?<base2>\w+)" \
    `comment("| rex field=data max_match=0 "[ <]search\s.*ref=\"(?<base3>\w+)" | eval base=mvsort(mvdedup(mvappend(base1, base2, base3))) ")` \
| eval base=mvsort(mvdedup(mvappend(base1, base2))) \
| eval BaseSearch = IF(isnull(base), "NONE", base) \
| eval Search=trim(mvappend(query, param)) \
| stats values(app) as App values(label) as Label values(author) as Author values(description) as Description values(BaseSearch) as BaseSearch last(updated) as Updated count by title Search \
| rename title as Title \
| rex field=Title "(?<Seal1>^\d+)_" \
| rex field=Label "(?<Seal2>^\d+)_" \
| rex field=Label "(?<Seal3>^\d+)\s?-" \
| rex field=Title "(?<Seal4>^\d+)-" \
| rex field=Title "_(?<Seal5>\d+)$" \
| rex field=Label "(?<Seal6>^\d+)\s" \
| rex field=App "_(?<Seal7>\d+)$" \
| rex field=Search "_(?<Seal8>\d{5,})" \
| rex field=Search "index=\"\*(?<Seal9>\d{5,})" \
| eval Seal=coalesce(Seal6, Seal7, Seal1,Seal2, Seal3, Seal4, Seal5, Seal8, Seal9) \
| eval Seal=case(Seal<999 OR Seal > 999999 OR Seal=2018, null(), true(), Seal) \
| eval Seal=if(isnull(Seal), 999999, Seal) \
| rex field=Search "index=\"(?<Index1>.*?)\"" max_match=0 \
| rex field=Search "index\s?=\s?(?<Index2>.*?)[\s)]" max_match=0 \
| rex field=Search "index=(?<Index3>.*?)$" max_match=0 \
| eval Index=coalesce(Index1, Index2, Index3) \
| eval Index=if(isnull(Index), "Unkown", Index) \
| rex field=App "(?<App_Name>.*?)_\d+" \
| eval App_Name= if(isnull(App_Name), App, App_Name) \
| eval App_Name= if(match(App, "_app$"), null(), App_Name) \
| eval Author=upper(trim(Author)) \
| eval Label=if(isnull(Label),Title,Label) \
| eval Label=if(Label="",Title,Label) \
| fields App App_Name Label Title Seal Index Author BaseSearch Updated Description Search \
| sort 0 + Label \
| outputlookup CCB_Splunk_SH_Dashboard_Analysis_Lookup_v1 createinapp=true create_empty=true append=false \
| stats count

[splunk_sh_rest_data_ui_views_lookup_gen]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = 0 21 * * *
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
display.events.fields = ["host","source","sourcetype","splunk_server_group"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | rest /servicesNS/-/-/data/ui/views timeout=0 search="isDashboard=1" search="isVisible=1" search="disabled=0" \
| rename eai:* as * \
| rename acl.* as * \
| fields app appName author can_change_perms can_list can_share_app can_share_global can_share_user can_write data description digest disabled id isDashboard isVisible label modifiable owner perms perms.read perms.write published removable rootNode sharing splunk_server title type updated userName \
| search NOT app IN (splunk_monitoring_console, Splunk_SA_*, Splunk_ML_*, Splunk_TA_*, TA-*, *_app, splunk-app*, lookup_editor, system, splunk-ps-technical-assessment) \
| search NOT title IN (home, integrity_check_of_installed_files, orphaned_scheduled_searches) \
| rex field=id mode=sed "s/^https:\/\/127.0.0.1:8089\/servicesNS\///g" \
| rex field=id mode=sed "s/^nobody/apps/g" \
| eval location=if(match(id, "^apps"), id, "users/" . id) \
| stats last(description) as description last(splunk_server) as splunk_server by app sharing title label type rootNode author location updated \
| table title label description app sharing type rootNode author splunk_server location updated \
| sort 0 + Label \
| outputlookup Splunk_SH_Rest_Data_UI_Views.csv createinapp=true create_empty=true append=false\
| stats count

[License Usage - Previous 30 Days]
action.email.useNSSubject = 1
alert.track = 0
auto_summarize.dispatch.earliest_time = -1mon@d
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
dispatchAs = user
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","source","host"]
display.general.timeRangePicker.show = 0
display.general.type = visualizations
display.page.search.mode = fast
display.page.search.tab = visualizations
display.statistics.rowNumbers = 1
display.statistics.show = 0
display.visualizations.charting.axisTitleX.text = Time
display.visualizations.charting.axisTitleY.text = TB
display.visualizations.charting.axisY.scale = log
display.visualizations.charting.chart.overlayFields = Total_License_Usage
display.visualizations.charting.chart.showDataLabels = minmax
display.visualizations.custom.number_display_viz.number_display_viz.bordercolor = #FFFFFF
display.visualizations.custom.number_display_viz.number_display_viz.bordersize = 2
display.visualizations.custom.number_display_viz.number_display_viz.colorprimary = #000000
display.visualizations.custom.number_display_viz.number_display_viz.colorprimarymode = auto
display.visualizations.custom.number_display_viz.number_display_viz.colorsecondary = #000000
display.visualizations.custom.number_display_viz.number_display_viz.colorsecondarymode = darker1
display.visualizations.custom.number_display_viz.number_display_viz.max = 100
display.visualizations.custom.number_display_viz.number_display_viz.min = 0
display.visualizations.custom.number_display_viz.number_display_viz.nodatacolor = #0178c7
display.visualizations.custom.number_display_viz.number_display_viz.padding = 10
display.visualizations.custom.number_display_viz.number_display_viz.pulserate = 4
display.visualizations.custom.number_display_viz.number_display_viz.shadowcolor = #F2F4F5
display.visualizations.custom.number_display_viz.number_display_viz.shapebordercolor = #FFFFFF
display.visualizations.custom.number_display_viz.number_display_viz.shapebordercolormode = static
display.visualizations.custom.number_display_viz.number_display_viz.shapebordersize = 1
display.visualizations.custom.number_display_viz.number_display_viz.shapedropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.shapeshadow = 1
display.visualizations.custom.number_display_viz.number_display_viz.shapetexture = solid
display.visualizations.custom.number_display_viz.number_display_viz.sparkHeight = 30
display.visualizations.custom.number_display_viz.number_display_viz.sparkWidth = 90
display.visualizations.custom.number_display_viz.number_display_viz.sparkalign = 5
display.visualizations.custom.number_display_viz.number_display_viz.sparkalignv = 70
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolorfill = #009DD9
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolorline = #0178c7
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolormodefill = auto
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolormodeline = auto
display.visualizations.custom.number_display_viz.number_display_viz.sparkmin = 0
display.visualizations.custom.number_display_viz.number_display_viz.sparknulls = gaps
display.visualizations.custom.number_display_viz.number_display_viz.sparkorder = bg
display.visualizations.custom.number_display_viz.number_display_viz.sparkstyle = area
display.visualizations.custom.number_display_viz.number_display_viz.spinnerspeedmax = 20
display.visualizations.custom.number_display_viz.number_display_viz.spinnerspeedmin = 1
display.visualizations.custom.number_display_viz.number_display_viz.style = g1
display.visualizations.custom.number_display_viz.number_display_viz.subtitlealign = center
display.visualizations.custom.number_display_viz.number_display_viz.subtitlealignv = 70
display.visualizations.custom.number_display_viz.number_display_viz.subtitlecolor = #5C6773
display.visualizations.custom.number_display_viz.number_display_viz.subtitlecolormode = static
display.visualizations.custom.number_display_viz.number_display_viz.subtitledrop = 1
display.visualizations.custom.number_display_viz.number_display_viz.subtitledropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.subtitlesize = 40
display.visualizations.custom.number_display_viz.number_display_viz.textalign = center
display.visualizations.custom.number_display_viz.number_display_viz.textalignv = 50
display.visualizations.custom.number_display_viz.number_display_viz.textcolor = #000000
display.visualizations.custom.number_display_viz.number_display_viz.textdrop = 1
display.visualizations.custom.number_display_viz.number_display_viz.textdropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.textduration = 300
display.visualizations.custom.number_display_viz.number_display_viz.textmode = static
display.visualizations.custom.number_display_viz.number_display_viz.textprecision = 1
display.visualizations.custom.number_display_viz.number_display_viz.textsize = 100
display.visualizations.custom.number_display_viz.number_display_viz.textunitposition = after
display.visualizations.custom.number_display_viz.number_display_viz.textunitsize = 50
display.visualizations.custom.number_display_viz.number_display_viz.thickness = 50
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol1 = #1a9035
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol2 = #d16f18
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol3 = #b22b32
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol4 = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol5 = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol6 = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.thresholdsize = 20
display.visualizations.custom.number_display_viz.number_display_viz.thresholdval2 = 70
display.visualizations.custom.number_display_viz.number_display_viz.thresholdval3 = 90
display.visualizations.custom.number_display_viz.number_display_viz.titlealign = center
display.visualizations.custom.number_display_viz.number_display_viz.titlealignv = 30
display.visualizations.custom.number_display_viz.number_display_viz.titlecolor = #5C6773
display.visualizations.custom.number_display_viz.number_display_viz.titlecolormode = static
display.visualizations.custom.number_display_viz.number_display_viz.titledrop = 1
display.visualizations.custom.number_display_viz.number_display_viz.titledropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.titlesize = 45
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = splunk_monitoring_console.KpiTrafficLight
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunkd source=*license_usage.log* type="RolloverSummary" earliest=-30d@d latest=-0d@d \
| rename slave AS Indexer_GUID, idx AS Index \
| eval Volume=round(b/1024/1024/1024/1024, 5) \
| lookup splunk_env_indexer_guid_csv_lookup Indexer_GUID OUTPUT Splunk_Env \
| fields _time Splunk_Env Volume \
| timechart sum(Volume) AS Volume by Splunk_Env span=1d fixedrange=false \
| eval Total_License_Usage = 'PROD-CM-1' + 'PROD-CM-2' + 'UAT-CM-1' + 'DEV-CM-1'

[Daily Ingestion by Index in last 14 Days]
action.email.useNSSubject = 1
alert.track = 0
auto_summarize.dispatch.earliest_time = -1mon@d
cron_schedule = 0 6 * * 1
dispatch.earliest_time = -7d@h
dispatch.latest_time = now
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","source","host"]
display.general.timeRangePicker.show = 0
display.general.type = visualizations
display.page.search.tab = visualizations
display.statistics.rowNumbers = 1
display.visualizations.charting.axisTitleX.text = Time
display.visualizations.charting.axisTitleY.text = TB
display.visualizations.charting.axisY.scale = log
display.visualizations.charting.chart.overlayFields = Total_License_Usage
display.visualizations.charting.chart.showDataLabels = all
display.visualizations.custom.number_display_viz.number_display_viz.bordercolor = #FFFFFF
display.visualizations.custom.number_display_viz.number_display_viz.bordersize = 2
display.visualizations.custom.number_display_viz.number_display_viz.colorprimary = #000000
display.visualizations.custom.number_display_viz.number_display_viz.colorprimarymode = auto
display.visualizations.custom.number_display_viz.number_display_viz.colorsecondary = #000000
display.visualizations.custom.number_display_viz.number_display_viz.colorsecondarymode = darker1
display.visualizations.custom.number_display_viz.number_display_viz.max = 100
display.visualizations.custom.number_display_viz.number_display_viz.min = 0
display.visualizations.custom.number_display_viz.number_display_viz.nodatacolor = #0178c7
display.visualizations.custom.number_display_viz.number_display_viz.padding = 10
display.visualizations.custom.number_display_viz.number_display_viz.pulserate = 4
display.visualizations.custom.number_display_viz.number_display_viz.shadowcolor = #F2F4F5
display.visualizations.custom.number_display_viz.number_display_viz.shapebordercolor = #FFFFFF
display.visualizations.custom.number_display_viz.number_display_viz.shapebordercolormode = static
display.visualizations.custom.number_display_viz.number_display_viz.shapebordersize = 1
display.visualizations.custom.number_display_viz.number_display_viz.shapedropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.shapeshadow = 1
display.visualizations.custom.number_display_viz.number_display_viz.shapetexture = solid
display.visualizations.custom.number_display_viz.number_display_viz.sparkHeight = 30
display.visualizations.custom.number_display_viz.number_display_viz.sparkWidth = 90
display.visualizations.custom.number_display_viz.number_display_viz.sparkalign = 5
display.visualizations.custom.number_display_viz.number_display_viz.sparkalignv = 70
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolorfill = #009DD9
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolorline = #0178c7
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolormodefill = auto
display.visualizations.custom.number_display_viz.number_display_viz.sparkcolormodeline = auto
display.visualizations.custom.number_display_viz.number_display_viz.sparkmin = 0
display.visualizations.custom.number_display_viz.number_display_viz.sparknulls = gaps
display.visualizations.custom.number_display_viz.number_display_viz.sparkorder = bg
display.visualizations.custom.number_display_viz.number_display_viz.sparkstyle = area
display.visualizations.custom.number_display_viz.number_display_viz.spinnerspeedmax = 20
display.visualizations.custom.number_display_viz.number_display_viz.spinnerspeedmin = 1
display.visualizations.custom.number_display_viz.number_display_viz.style = g1
display.visualizations.custom.number_display_viz.number_display_viz.subtitlealign = center
display.visualizations.custom.number_display_viz.number_display_viz.subtitlealignv = 70
display.visualizations.custom.number_display_viz.number_display_viz.subtitlecolor = #5C6773
display.visualizations.custom.number_display_viz.number_display_viz.subtitlecolormode = static
display.visualizations.custom.number_display_viz.number_display_viz.subtitledrop = 1
display.visualizations.custom.number_display_viz.number_display_viz.subtitledropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.subtitlesize = 40
display.visualizations.custom.number_display_viz.number_display_viz.textalign = center
display.visualizations.custom.number_display_viz.number_display_viz.textalignv = 50
display.visualizations.custom.number_display_viz.number_display_viz.textcolor = #000000
display.visualizations.custom.number_display_viz.number_display_viz.textdrop = 1
display.visualizations.custom.number_display_viz.number_display_viz.textdropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.textduration = 300
display.visualizations.custom.number_display_viz.number_display_viz.textmode = static
display.visualizations.custom.number_display_viz.number_display_viz.textprecision = 1
display.visualizations.custom.number_display_viz.number_display_viz.textsize = 100
display.visualizations.custom.number_display_viz.number_display_viz.textunitposition = after
display.visualizations.custom.number_display_viz.number_display_viz.textunitsize = 50
display.visualizations.custom.number_display_viz.number_display_viz.thickness = 50
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol1 = #1a9035
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol2 = #d16f18
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol3 = #b22b32
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol4 = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol5 = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.thresholdcol6 = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.thresholdsize = 20
display.visualizations.custom.number_display_viz.number_display_viz.thresholdval2 = 70
display.visualizations.custom.number_display_viz.number_display_viz.thresholdval3 = 90
display.visualizations.custom.number_display_viz.number_display_viz.titlealign = center
display.visualizations.custom.number_display_viz.number_display_viz.titlealignv = 30
display.visualizations.custom.number_display_viz.number_display_viz.titlecolor = #5C6773
display.visualizations.custom.number_display_viz.number_display_viz.titlecolormode = static
display.visualizations.custom.number_display_viz.number_display_viz.titledrop = 1
display.visualizations.custom.number_display_viz.number_display_viz.titledropcolor = #ffffff
display.visualizations.custom.number_display_viz.number_display_viz.titlesize = 45
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = splunk_monitoring_console.KpiTrafficLight
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = index=_internal sourcetype=splunkd source=*license_usage.log*  earliest=-14d@d\
| eval TB_Ingestion = round(b /1024 / 1024 / 1024 / 1024, 2) \
| timechart sum(TB_Ingestion) as TB_Ingestion span=1d

[splunk_idx_audit_data_ingestion_kv_store_lookup_tracker]
action.email.useNSSubject = 1
alert.track = 0
cron_schedule = */5 * * * *
dispatch.earliest_time = -5m@m
dispatch.latest_time = -0m@m
display.events.fields = ["b","h","i","idx","o","pool","poolsz","s","st","type","slave","stack","stacksz","host","event_message","component","log_level","userName","username","source","current_size","current_size_kb","blocked","largest_size","max_size_kb","smallest_size","index","splunk_server"]
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.format.0 = number
display.statistics.format.0.field = count
display.statistics.format.0.unit = Records
display.statistics.format.1 = number
display.statistics.format.1.field = count
display.statistics.format.1.unit = Records
display.statistics.rowNumbers = 1
display.statistics.wrap = 0
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.custom.type = sankey_diagram_app.sankey_diagram
display.visualizations.show = 0
enableSched = 1
request.ui_dispatch_app = splunk_global_monitoring_console
request.ui_dispatch_view = search
search = | tstats\
    min(_indextime) as Earliest_Index_Time_Seen\
    max(_indextime) as Latest_Index_Time_Seen\
    min(_time) as Earliest_Time_Seen\
    max(_time) as Latest_Time_Seen\
    by host index sourcetype \
| eval host = upper(host) \
| rex field=host mode=sed "s/.\w+.\w+.JPMCHASE.NET|.\w+.BANKONE.NET|.\w+.JPMCHASE.NET|\d+.CORE-APP-CHASE.APPS.PROD.NA|:\d+$//g" \
| rex field=host "(?<hostip>^\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3})" \
| eval hostname = if(isnull(hostip), host, null()) \
| rex field=hostname mode=sed "s/.\w+.\w+.\w+.NET|.\w+.\w+.NET|:\d+$//g" \
| eval host = if(isnotnull(hostname), hostname, hostip) \
| search host != "" \
| eval locator = md5(lower(host + index + sourcetype)) \
| stats \
    min(Earliest_Index_Time_Seen) as Earliest_Index_Time_Seen\
    max(Latest_Index_Time_Seen) as Latest_Index_Time_Seen\
    min(Earliest_Time_Seen) as Earliest_Time_Seen\
    max(Latest_Time_Seen) as Latest_Time_Seen\
    last(host) as host\
    last(index) as index\
    last(sourcetype) as sourcetype\
    by locator \
| table locator host index sourcetype Earliest_Index_Time_Seen Latest_Index_Time_Seen Earliest_Time_Seen Latest_Time_Seen \
| outputlookup splunk_idx_audit_data_ingestion_kv_store_lookup key_field=locator createinapp=true \
| stats count

[Splunk CPU & Memory Information & Memory]
action.email = 1
action.email.include.search = 1
action.email.inline = 1
action.email.priority = 1
action.email.sendcsv = 1
action.email.sendpdf = 1
action.email.sendresults = 1
action.email.to = amir.khamis2@gmail.com
action.email.useNSSubject = 1
action.logevent = 1
action.logevent.param.event = testing123
action.logevent.param.host = test123
action.lookup = 1
action.lookup.filename = test.csv
action.outputtelemetry = 1
action.outputtelemetry.param.component = test123
action.outputtelemetry.param.input = test123
action.outputtelemetry.param.license = 1
action.outputtelemetry.param.optinrequired = 3
action.script = 1
action.script.filename = test.sh
alert.track = 0
cron_schedule = */2 * * * *
dispatch.earliest_time = -1s@s
dispatch.latest_time = now
display.general.timeRangePicker.show = 0
display.general.type = statistics
display.page.search.mode = fast
display.page.search.tab = statistics
display.statistics.rowNumbers = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showLegend = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showTooltip = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showXAxis = 1
display.visualizations.custom.splunk_monitoring_console.heatmap.showYAxis = 1
display.visualizations.show = 0
request.ui_dispatch_app = splunk_monitoring_console
request.ui_dispatch_view = search
schedule_priority = highest
search = | rest splunk_server=* /services/server/info \
| fields serverName, numberOfCores, numberOfVirtualCores, physicalMemoryMB \
| rename numberOfCores as numberOfPhyscialCores \
| eval physicalMemoryGB = round(physicalMemoryMB/1024) \
| table serverName, numberOfPhyscialCores, numberOfVirtualCores, physicalMemoryGB
