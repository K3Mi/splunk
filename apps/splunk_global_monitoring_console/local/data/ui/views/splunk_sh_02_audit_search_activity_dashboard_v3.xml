<form theme="dark">
  <label>Splunk - SH - 02 - Audit Search Activity - Dashboard - v3</label>
  <search id="Splunk_Monitoring_Introspection_Search_Usage">
    <query>
| tstats SUMMARIESONLY=TRUE ALLOW_OLD_SUMMARIES=FALSE 
    latest(Search_Activity.Introspection_Search_Usage.acceleration_id) AS acceleration_id
    latest(Search_Activity.Introspection_Search_Usage.app3) AS app
    max(Search_Activity.Introspection_Search_Usage.delta_scan_count) AS delta_scan_count
    max(Search_Activity.Introspection_Search_Usage.total_run_time3) AS total_run_time
    max(Search_Activity.Introspection_Search_Usage.fd_used) AS fd_used
    max(Search_Activity.Introspection_Search_Usage.mem_used) AS mem_used
    max(Search_Activity.Introspection_Search_Usage.normalized_pct_cpu) AS normalized_pct_cpu
    max(Search_Activity.Introspection_Search_Usage.page_faults) AS page_faults
    max(Search_Activity.Introspection_Search_Usage.pct_cpu) AS pct_cpu
    max(Search_Activity.Introspection_Search_Usage.pct_memory) AS pct_memory
    latest(Search_Activity.Introspection_Search_Usage.provenance) AS provenance
    max(Search_Activity.Introspection_Search_Usage.read_mb) AS read_mb
    latest(Search_Activity.Introspection_Search_Usage.savedsearch_name3) AS savedsearch_name
    max(Search_Activity.Introspection_Search_Usage.scan_count3) AS scan_count
    latest(Search_Activity.Introspection_Search_Usage.search_type3) AS search_type
    latest(Search_Activity.Introspection_Search_Usage.status) AS status
    max(Search_Activity.Introspection_Search_Usage.t_count) AS t_count
    latest(Search_Activity.Introspection_Search_Usage.user3) AS user
    max(Search_Activity.Introspection_Search_Usage.written_mb) AS written_mb
    latest(Search_Activity.Introspection_Search_Usage.search_head) as search_head
    latest(Search_Activity.Introspection_Search_Usage.mode) as mode
    values(host) as host
    latest(_time) as _time
  
    FROM DATAMODEL=Splunk_Search_Logs
  
    WHERE nodename=Search_Activity.Introspection_Search_Usage
    index=_introspection
    AND Search_Activity.Introspection_Search_Usage.app3 = "$app$"
    AND Search_Activity.Introspection_Search_Usage.search_type3 = "$search_type$"
    AND Search_Activity.Introspection_Search_Usage.user3 = "$user$"
    AND Search_Activity.Introspection_Search_Usage.savedsearch_name3 = "$savedsearch_name$"
    AND host="$host$"
  
    BY Search_Activity.Introspection_Search_Usage.search_id Search_Activity.Introspection_Search_Usage.pid

| rename Search_Activity.Introspection_Search_Usage.* as * 

| fields _time host search_id search_head app user acceleration_id delta_scan_count total_run_time fd_used mem_used normalized_pct_cpu page_faults pct_cpu pct_memory pid provenance read_mb savedsearch_name scan_count search_type status t_count written_mb mode

| fillnull value=0 delta_scan_count total_run_time fd_used mem_used normalized_pct_cpu page_faults pct_cpu pct_memory read_mb scan_count t_count written_mb 

| fillnull value="Undefined" search_head app user acceleration_id provenance savedsearch_name search_type status mode

| eval mem_used=round(mem_used/1024, 2) 
| rex field=search_id "_(?&lt;search_id_normalized1&gt;\d+[._]\d+)_" 
| rex field=search_id "(?&lt;search_id_normalized2&gt;\d+[._]\d+$)" 
| rex field=search_id "(?&lt;search_id_normalized3&gt;^\d+[._]\d+)" 
| eval search_id_normalized = if(isnull(search_id_normalized1), search_id_normalized2, search_id_normalized1) 
| eval search_id_normalized = if(isnull(search_id_normalized), search_id_normalized3, search_id_normalized) 
| eval search_id_normalized = if(isnull(search_id_normalized), search_id, search_id_normalized) 
| rex field=search_id_normalized mode=sed "s/\./_/g" 
| rex field=acceleration_id "_DM_(?&lt;datamodel&gt;.*)" 
| eval acceleration_id_report=if(type="report_acceleration", acceleration_id, null()) 
| eval datamodel_acceleration=if(provenance="summary_director", acceleration_id, null()) 
| rex field=acceleration_id_report "_(?&lt;accelerated_report&gt;\w+$)"
| eval host=upper(host) , user=upper(user) , search_head=upper(search_head)
| rex field=provenance "(?&lt;Provenance_Type&gt;.*?):(?&lt;Provenance_KO_Type&gt;.*?):(?&lt;Provenance_KO&gt;.*?)$"
| eval provenance_tmp=if(isnull(Provenance_Type), provenance, null())
| rex field=provenance_tmp "(?&lt;Provenance_Type&gt;.*?):(?&lt;Provenance_KO_Type&gt;.*?)$"
| eval provenance_tmp=if(isnull(Provenance_Type), provenance, null())
| rex field=provenance_tmp "(?&lt;Provenance_Type&gt;.*?)$"
| eval Dashboard_Name = if(Provenance_KO_Type="Dashboard", Provenance_KO, null() )

| `get_splunk_env(host)`

| fields - search_id_normalized1 search_id_normalized2 search_id_normalized3 acceleration_id_report datamodel_acceleration provenance_tmp
| fillnull value="Undefined" search_id_normalized datamodel Provenance_Type Provenance_KO_Type Provenance_KO Splunk_Role Dashboard_Name

| `get_saved_searches_info(app,savedsearch_name)`

| `get_identity_info(user)`

| search search_id_normalized = "*$search_id_normalized$*" AND mem_used &gt;= $mem_used$ AND search_head="$search_head$" AND pid=$pid$ AND datamodel="$datamodel$" AND Provenance_Type="$Provenance_Type$" AND Provenance_KO_Type="$Provenance_KO_Type$" AND Provenance_KO="$Provenance_KO$" AND total_run_time &gt; $total_run_time$ AND LOB="$LOB$" AND Department = "$Department$" AND City="$City$" AND State="$State$" AND Country="$Country$" AND mode="$mode$" Splunk_Role="$Splunk_Role$"

      </query>
    <earliest>$TimeRangePkr1.earliest$</earliest>
    <latest>$TimeRangePkr1.latest$</latest>
  </search>
  <search id="Splunk_Monitoring_Audit_Search">
    <query>
| tstats SUMMARIESONLY=TRUE ALLOW_OLD_SUMMARIES=FALSE 
    latest(Search_Activity.Audit_Search.available_count) AS available_count
    latest(Search_Activity.Audit_Search.considered_events) AS considered_events
    latest(Search_Activity.Audit_Search.datamodel1) AS datamodel
    latest(Search_Activity.Audit_Search.decompressed_slices) AS decompressed_slices
    latest(Search_Activity.Audit_Search.event_count) AS event_count
    latest(Search_Activity.Audit_Search.dispatch_time1) AS dispatch_time
    latest(Search_Activity.Audit_Search.exec_time) AS exec_time
    latest(Search_Activity.Audit_Search.result_count1) AS result_count
    latest(Search_Activity.Audit_Search.roles) AS roles
    latest(Search_Activity.Audit_Search.savedsearch_name1) AS savedsearch_name
    latest(Search_Activity.Audit_Search.scan_count1) AS scan_count
    latest(Search_Activity.Audit_Search.search) AS search
    latest(Search_Activity.Audit_Search.search_et) AS search_et
    latest(Search_Activity.Audit_Search.search_lt) AS search_lt
    latest(Search_Activity.Audit_Search.search_startup_time) AS search_startup_time
    latest(Search_Activity.Audit_Search.search_type1) AS search_type
    latest(Search_Activity.Audit_Search.searched_buckets) AS searched_buckets
    latest(Search_Activity.Audit_Search.total_run_time1) AS total_run_time
    latest(Search_Activity.Audit_Search.total_slices) AS total_slices
    latest(Search_Activity.Audit_Search.user1) AS user
    values(host) as host
   
    FROM DATAMODEL=Splunk_Search_Logs
   
    WHERE nodename=Search_Activity.Audit_Search
    index=_audit
    AND Search_Activity.Audit_Search.search_type1 = "$search_type$"
    AND Search_Activity.Audit_Search.info1 = "$info$"
    AND Search_Activity.Audit_Search.user1 = "$user$"
    AND Search_Activity.Audit_Search.savedsearch_name1 = "$savedsearch_name$"
    AND host = "$host$"
   
    BY _time Search_Activity.Audit_Search.search_id Search_Activity.Audit_Search.info1 $span_period$

| rename Search_Activity.Audit_Search.* as * , info1 AS info
| fields _time host available_count considered_events datamodel decompressed_slices event_count dispatch_time exec_time info result_count roles savedsearch_name scan_count search search_et search_id search_lt search_startup_time search_type searched_buckets total_run_time total_slices user

| eval search_class = case(match(search, "\|\s*rest"), "Rest", match(search, "\|\s*tstats"), "Tstats", true(), "Other")
| rex field=search mode=sed "s/^search\s//g"
| eval search=if(search="search", null(), search)
| eval search_size = len(search) | fillnull value=0 search_size
| rex field=search_id "_(?&lt;search_id_normalized1&gt;\d+[._]\d+)_" 
| rex field=search_id "(?&lt;search_id_normalized2&gt;\d+[._]\d+$)" 
| rex field=search_id "(?&lt;search_id_normalized3&gt;^\d+[._]\d+)" 
| eval search_id_normalized = if(isnull(search_id_normalized1), search_id_normalized2, search_id_normalized1) 
| eval search_id_normalized = if(isnull(search_id_normalized), search_id_normalized3, search_id_normalized) 
| rex field=search_id_normalized mode=sed "s/\./_/g"
| rex field=savedsearch_name "^_ACCELERATE_DM_(?&lt;datamodel&gt;.*)\.(?&lt;dataset&gt;.*?)_ACCELERATE_$" 
| eval savedsearch_name2 = if(isnull(datamodel) AND savedsearch_name!="N/A", savedsearch_name, null()) 
| rex field=savedsearch_name2 "^_ACCELERATE_DM_(?&lt;datamodel&gt;.*)_ACCELERATE_$"
| rex field=search max_match=0 "[dD][aA][tT][aA][mM][oO][dD][eE][lL][=:]\"?(?&lt;datamodel&gt;\w+)" 
| rex field=search max_match=0 "[dD][aA][tT][aA][mM][oO][dD][eE][lL][=:]\"?\w+\.(?&lt;dataset&gt;\w+)" 
| rex field=search max_match=0 "nodename=\"?(?&lt;dataset&gt;\w+)"
| eval host=upper(host) , user=upper(user)

| `get_lookup_reference(search)`

| `get_splunk_env(host)`

| `get_identity_info(user)`

| `get_saved_searches_info(savedsearch_name)`

| fillnull value=0 available_count considered_events decompressed_slices event_count result_count scan_count searched_buckets total_run_time total_slices

| fillnull value="Undefined" host datamodel info roles savedsearch_name search_id search_type user search_class search_id_normalized dataset Author_Roles Splunk_Role search Identity Name Title Phone Email Emp_Type Emp_Status City State Country Region Location_Code Floor_Number startDate endDate Department LOB Cost_Center Manager Contractor_Expiration

| search search_id_normalized="*$search_id_normalized$*" search="*$search$*" total_run_time&gt;$total_run_time$ search_class="$search_class$" search_size&gt;$search_size$ datamodel="$datamodel$" dataset="$dataset$" searched_buckets&gt;$searched_buckets$ LOB="$LOB$" Department="$Department$" City="$City$" State="$State$" Country="$Country$" Splunk_Role="$Splunk_Role$" Lookup_Reference="$Lookup_Reference$" savedsearch_type="$savedsearch_type$"

</query>
    <earliest>$TimeRangePkr2.earliest$</earliest>
    <latest>$TimeRangePkr2.latest$</latest>
  </search>
  <search id="Splunk_Monitoring_Internal_Scheduler">
    <query>
| tstats SUMMARIESONLY=TRUE ALLOW_OLD_SUMMARIES=FALSE 
    latest(Search_Activity.Internal_Scheduler.app2) AS app
    latest(Search_Activity.Internal_Scheduler.concurrency_category) AS concurrency_category
    latest(Search_Activity.Internal_Scheduler.concurrency_context) AS concurrency_context
    latest(Search_Activity.Internal_Scheduler.concurrency_limit) AS concurrency_limit
    latest(Search_Activity.Internal_Scheduler.dispatch_time2) AS dispatch_time
    latest(Search_Activity.Internal_Scheduler.priority) AS priority
    latest(Search_Activity.Internal_Scheduler.reason) AS reason
    latest(Search_Activity.Internal_Scheduler.result_count2) AS result_count
    latest(Search_Activity.Internal_Scheduler.total_run_time2) AS total_run_time
    latest(Search_Activity.Internal_Scheduler.savedsearch_id) AS savedsearch_id
    latest(Search_Activity.Internal_Scheduler.savedsearch_name2) AS savedsearch_name
    latest(Search_Activity.Internal_Scheduler.scheduled_time) AS scheduled_time
    latest(Search_Activity.Internal_Scheduler.search_type2) AS search_type
    latest(Search_Activity.Internal_Scheduler.skipped_count) AS skipped_count
    latest(Search_Activity.Internal_Scheduler.info2) AS info
    latest(Search_Activity.Internal_Scheduler.user2) AS user
    latest(Search_Activity.Internal_Scheduler.window_time) AS window_time
    latest(Search_Activity.Internal_Scheduler.alert_actions) AS alert_actions
    values(host) as host
   
    FROM DATAMODEL=Splunk_Search_Logs
   
    WHERE nodename=Search_Activity.Internal_Scheduler
    index=_internal
    AND Search_Activity.Internal_Scheduler.savedsearch_name2 = "$savedsearch_name$"
    AND Search_Activity.Internal_Scheduler.app2 = "$app$"
    AND Search_Activity.Internal_Scheduler.search_type2 = "$search_type$" 
    AND Search_Activity.Internal_Scheduler.info2 = "$info$"
    AND Search_Activity.Internal_Scheduler.user2 = "$user$"
    AND host = "$host$"
   
    BY _time Search_Activity.Internal_Scheduler.search_id $span_period$

| rename Search_Activity.Internal_Scheduler.* AS *

| fields _time host app search_id_normalized concurrency_category concurrency_context concurrency_limit dispatch_time priority reason result_count total_run_time savedsearch_id savedsearch_name scheduled_time search_id search_type skipped_count info user window_time alert_actions

| eval user = if(user = "nobody", "splunk-system-user", user)
| rex field=savedsearch_name "_ACCELERATE_DM_(?&lt;app&gt;.*?)_"
| eval savedsearch_name = case(match(savedsearch_name, "_ACCELERATE_|^search\d+"), NULL(), true(), savedsearch_name)
| eval window_time = if(window_time="-1", "auto", window_time) 
| rex field=search_id "_(?&lt;search_id_normalized1&gt;\d+[._]\d+)_" 
| rex field=search_id "(?&lt;search_id_normalized2&gt;\d+[._]\d+$)" 
| rex field=search_id "(?&lt;search_id_normalized3&gt;^\d+[._]\d+)" 
| eval search_id_normalized = if(isnull(search_id_normalized1), search_id_normalized2, search_id_normalized1) 
| eval search_id_normalized = if(isnull(search_id_normalized), search_id_normalized3, search_id_normalized) 
| eval search_id_normalized = if(isnull(search_id_normalized), search_id, search_id_normalized)
| rex field=search_id_normalized mode=sed "s/\./_/g"
| rex field=savedsearch_id "(?&lt;DM_User&gt;^.*?);(?&lt;DM_App&gt;.*?);_ACCELERATE_DM_(?&lt;datamodel&gt;.*)_ACCELERATE_$"
| eval host=upper(host) , user=upper(user)

| `get_splunk_env(host)`

| `get_identity_info(user)`

| `get_saved_searches_info(app,savedsearch_name)`

| fillnull window_time value="auto"
| fillnull value=0 concurrency_limit result_count total_run_time skipped_count
| fillnull value="Undefined" host app search_id_normalized concurrency_category concurrency_context priority reason savedsearch_id savedsearch_name search_id search_type info user window_time alert_actions Author_Roles Splunk_Role Name Title Phone Email Emp_Type Emp_Status City State Country Region Location_Code Floor_Number startDate endDate Department LOB Cost_Center Manager Contractor_Expiration

| search search_id_normalized = "*$search_id_normalized$*" AND priority="$priority$" AND window_time="$window_time$" AND concurrency_category="$concurrency_category$" AND concurrency_context="$concurrency_context$" AND concurrency_limit="$concurrency_limit$" AND reason="$reason$" AND total_run_time &gt; $total_run_time$ AND LOB="$LOB$" AND Department = "$Department$" AND City="$City$" AND State="$State$" AND Country="$Country$" Splunk_Role="$Splunk_Role$"
      </query>
    <earliest>$TimeRangePkr3.earliest$</earliest>
    <latest>$TimeRangePkr3.latest$</latest>
  </search>
  <fieldset submitButton="true" autoRun="true">
    <input type="dropdown" token="span_period" searchWhenChanged="true">
      <label>Span:</label>
      <default>span=1s</default>
      <choice value="">Automatic</choice>
      <choice value="span=1s">1 seconds</choice>
      <choice value="span=5s">5 seconds</choice>
      <choice value="span=10s">10 seconds</choice>
      <choice value="span=15s">15 seconds</choice>
      <choice value="span=30s">30 seconds</choice>
      <choice value="span=1m">1 minute</choice>
      <choice value="span=5m">5 minutes</choice>
      <choice value="span=10m">10 minutes</choice>
      <choice value="span=15m">15 minutes</choice>
      <choice value="span=30m">30 minutes</choice>
      <choice value="span=45m">45 minutes</choice>
      <choice value="span=1h">1 hour</choice>
      <choice value="span=2h">2 hours</choice>
      <choice value="span=3h">3 hours</choice>
      <choice value="span=4h">4 hours</choice>
      <choice value="span=6h">6 hours</choice>
      <choice value="span=8h">8 hours</choice>
      <choice value="span=12h">12 hours</choice>
      <choice value="span=1d">1 day</choice>
      <choice value="span=1w">1 week</choice>
      <choice value="span=1mon">1 month</choice>
      <choice value="span=12mon">1 year</choice>
      <initialValue>span=1s</initialValue>
    </input>
  </fieldset>
  <row id="style_settings" depends="$visible$">
    <panel depends="$alwaysHideCSS$">
      <html>
         <style>
           <!--.dashboard-body {-->
           <!--    background: #a6a6a6 !important;-->
           <!--}-->
           .dashboard-panel h2{
             background:#FFA500 !important;
             color:black !important;
             text-align: center !important;
             font-weight: bold !important;
             border-top-right-radius: 15px;
             border-top-left-radius: 15px; }
            .dashboard-panel h1.panel-title {
              font-weight: bold !important;
              font-size: 100% !important; }
                .table, th, td {
              border: 8px solid black !important; }
            { display: none;  }
         </style>
       </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Introspection Search Usage</title>
      <input type="time" token="TimeRangePkr1" searchWhenChanged="true">
        <label>Introspection Time Range</label>
        <default>
          <earliest>-60m@m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <input type="dropdown" token="Splunk_Role" searchWhenChanged="true">
        <label>Splunk Role</label>
        <choice value="*">All</choice>
        <fieldForLabel>Splunk_Role</fieldForLabel>
        <fieldForValue>Splunk_Role</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by Splunk_Role</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="host" searchWhenChanged="true">
        <label>Host</label>
        <choice value="*">All</choice>
        <fieldForLabel>host</fieldForLabel>
        <fieldForValue>host</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by host</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID</label>
        <choice value="*">All</choice>
        <fieldForLabel>search_id_normalized</fieldForLabel>
        <fieldForValue>search_id_normalized</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by search_id_normalized </query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_type" searchWhenChanged="true">
        <label>Search Type</label>
        <choice value="*">All</choice>
        <choice value="adhoc">Ad-Hoc</choice>
        <choice value="datamodel_acceleration">Datamodel Acceleration</choice>
        <choice value="report_acceleration">Report Acceleration</choice>
        <choice value="scheduled">Scheduled</choice>
        <choice value="summary_indexing">Summary Indexing</choice>
        <fieldForLabel>search_type</fieldForLabel>
        <fieldForValue>search_type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="mode" searchWhenChanged="true">
        <label>Search Mode</label>
        <choice value="*">All</choice>
        <choice value="RT">Real-Time</choice>
        <choice value="RT indexed">Real-Time Indexed</choice>
        <choice value="historical">Historical</choice>
        <choice value="historical batch">Historical Batch</choice>
        <fieldForLabel>mode</fieldForLabel>
        <fieldForValue>mode</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="app" searchWhenChanged="true">
        <label>App</label>
        <choice value="*">All</choice>
        <fieldForLabel>app</fieldForLabel>
        <fieldForValue>app</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by app</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="savedsearch_name" searchWhenChanged="true">
        <label>Savedsearch Name</label>
        <choice value="*">All</choice>
        <fieldForLabel>savedsearch_name</fieldForLabel>
        <fieldForValue>savedsearch_name</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by savedsearch_name</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Provenance_Type" searchWhenChanged="true">
        <label>Provenance</label>
        <choice value="*">All</choice>
        <fieldForLabel>Provenance_Type</fieldForLabel>
        <fieldForValue>Provenance_Type</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by Provenance_Type</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Provenance_KO_Type" searchWhenChanged="true">
        <label>Object Type</label>
        <choice value="*">All</choice>
        <fieldForLabel>Provenance_KO_Type</fieldForLabel>
        <fieldForValue>Provenance_KO_Type</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by Provenance_KO_Type</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Provenance_KO" searchWhenChanged="true">
        <label>Object Name</label>
        <choice value="*">All</choice>
        <fieldForLabel>Provenance_KO</fieldForLabel>
        <fieldForValue>Provenance_KO</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by Provenance_KO</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="datamodel" searchWhenChanged="true">
        <label>Datamodel</label>
        <choice value="*">All</choice>
        <fieldForLabel>datamodel</fieldForLabel>
        <fieldForValue>datamodel</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by datamodel</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="LOB" searchWhenChanged="true">
        <label>LOB</label>
        <choice value="*">All</choice>
        <fieldForLabel>LOB</fieldForLabel>
        <fieldForValue>LOB</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by LOB</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Department" searchWhenChanged="true">
        <label>Department</label>
        <choice value="*">All</choice>
        <fieldForLabel>Department</fieldForLabel>
        <fieldForValue>Department</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by Department</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="City" searchWhenChanged="true">
        <label>City</label>
        <choice value="*">All</choice>
        <fieldForLabel>City</fieldForLabel>
        <fieldForValue>City</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by City</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="State" searchWhenChanged="true">
        <label>State</label>
        <choice value="*">All</choice>
        <fieldForLabel>State</fieldForLabel>
        <fieldForValue>State</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by State</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Country" searchWhenChanged="true">
        <label>Country</label>
        <choice value="*">All</choice>
        <fieldForLabel>Country</fieldForLabel>
        <fieldForValue>Country</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by Country</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_head" searchWhenChanged="true">
        <label>Search Head</label>
        <choice value="*">All</choice>
        <fieldForLabel>search_head</fieldForLabel>
        <fieldForValue>search_head</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by search_head</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="user" searchWhenChanged="true">
        <label>User</label>
        <choice value="*">All</choice>
        <fieldForLabel>user</fieldForLabel>
        <fieldForValue>user</fieldForValue>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by user</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="mem_used" searchWhenChanged="true">
        <label>Memory Used (&gt;=)</label>
        <default>0</default>
        <initialValue>0</initialValue>
      </input>
      <input type="text" token="pid" searchWhenChanged="true">
        <label>PID</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="search_id2" searchWhenChanged="true">
        <label>Search ID (Contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="Provenance_KO" searchWhenChanged="true">
        <label>Object Name</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID (Contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="total_run_time" searchWhenChanged="true">
        <label>Total Run Time in Seconds &gt;</label>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <table>
        <title>To Drilldown on a Normalized Search ID to see information on it from _audit &amp; _internal click inside the field value of  the "Normalized Search ID" Field</title>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| eval _time = strftime(_time,"%m/%d/%Y %H:%M:%S") , Earliest_Access_Updated = strftime(Earliest_Access_Updated,"%m/%d/%Y %H:%M:%S") , Latest_Access_Updated = strftime(Latest_Access_Updated,"%m/%d/%Y %H:%M:%S") , min_spent=min_spent/1000, max_spent=max_spent/1000 , avg_spent=avg_spent/1000 
| `gmc_convert_runtime('total_run_time')` 
| table Splunk_Role host search_head search_id_normalized search_type mode savedsearch_name _time 'total_run_time' total_run_time mem_used normalized_pct_cpu app user Name Title LOB Department Cost_Center Phone Email Emp_Type Emp_Status City State Country Region Floor_Number Location_Code Manager Contractor_Expiration Provenance_KO_Type Provenance_Type Provenance_KO Dashboard_Name Dash_avg_spent Dash_min_spent Dash_max_spent Rep_Dispatch_Time Rep_Latest_Run_Time Rep_Priority Rep_Result_Count Rep_Run_Time Rep_Scheduled_Time Rep_User Rep_Window_Time datamodel delta_scan_count endDate fd_used page_faults pct_cpu pct_memory pid provenance read_mb scan_count startDate status t_count written_mb 
| sort 0 - total_run_time 
| rename _time as "Search Time" , host as Host , search_head as "Search Head" , search_id as "Search ID" , search_id_normalized as "Normalized Search ID" , pid as PID , user as User , search_type as "Search Type" , provenance as Provenance , savedsearch_name as "Savedsearch Name" , datamodel as Datamodel , dataset as Dataset , mem_used as "Memory Used" , "pct_memory" as "Memory %" , normalized_pct_cpu as "Normalized CPU %" , pct_cpu as "CPU %" , t_count as "Total Count" , scan_count as "Scan Count" , delta_scan_count as "Delta Scan Count" , fd_used as "FD Used" , page_faults as "Page Faults" , read_mb as "Read MB" , written_mb as "Written MB" , status as Status , acceleration_id as "Acceleration ID" , app as App, 'total_run_time' as Runtime, total_run_time as Runtime_Sec, mode as "Search Mode"</query>
        </search>
        <option name="count">5</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format type="color" field="App">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Runtime_Sec">
          <option name="unit">Seconds</option>
        </format>
        <format type="color" field="Runtime_Sec">
          <colorPalette type="list">[#53A051,#006D9C,#F8BE34,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">0,300,600,900</scale>
        </format>
        <format type="color" field="Memory Used">
          <colorPalette type="list">[#53A051,#EC9960,#F8BE34,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">1,10,20,50</scale>
        </format>
        <format type="number" field="Memory Used">
          <option name="unit">GB</option>
        </format>
        <format type="color" field="User">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Datamodel">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search Mode">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Provenance_KO_Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Provenance_KO">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Provenance_Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Host">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Savedsearch Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Normalized Search ID">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Normalized CPU %">
          <option name="unit">%</option>
        </format>
        <format type="color" field="Normalized CPU %">
          <colorPalette type="list">[#53A051,#006D9C,#F8BE34,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">0,30,70,100</scale>
        </format>
        <format type="number" field="Scan Count">
          <option name="precision">0</option>
        </format>
        <format type="number" field="FD Used">
          <option name="precision">0</option>
        </format>
        <format type="number" field="min_spent">
          <option name="unit">s</option>
        </format>
        <format type="number" field="max_spent">
          <option name="unit">s</option>
        </format>
        <format type="number" field="avg_spent">
          <option name="unit">s</option>
        </format>
        <format type="number" field="Read MB">
          <option name="unit">MB</option>
        </format>
        <format type="number" field="Written MB">
          <option name="unit">MB</option>
        </format>
        <drilldown>
          <set token="search_id_normalized">$click.value2$</set>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Dashboard Drilldown</title>
      <table>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by Provenance_KO 
| where Provenance_KO!="Undefined"
| fields Provenance_KO
| rename Provenance_KO as "Dashboard Title"</query>
        </search>
        <option name="count">3</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="wrap">false</option>
        <drilldown>
          <link target="_blank">/app/splunk_global_monitoring_console/splunk_sh_03_knowledge_objects_analysis_dashboard_v2?form.Dashboard_Title=$click.value2$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Report/Alert Drilldown</title>
      <table>
        <search base="Splunk_Monitoring_Introspection_Search_Usage">
          <query>| stats count by savedsearch_name 
| where savedsearch_name!="Undefined"
| fields savedsearch_name
| rename savedsearch_name as "Report/Alert Name"</query>
        </search>
        <option name="count">3</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">none</option>
        <option name="wrap">false</option>
        <drilldown>
          <link target="_blank">/app/splunk_global_monitoring_console/splunk_sh_03_knowledge_objects_analysis_dashboard_v2?form.Name=$click.value2$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Audit Search Usage</title>
      <input type="time" token="TimeRangePkr2" searchWhenChanged="true">
        <label>Audit Time Range</label>
        <default>
          <earliest>-15m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <input type="dropdown" token="Splunk_Role" searchWhenChanged="true">
        <label>Splunk Role</label>
        <choice value="*">All</choice>
        <fieldForLabel>Splunk_Role</fieldForLabel>
        <fieldForValue>Splunk_Role</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by Splunk_Role</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID</label>
        <choice value="*">All</choice>
        <fieldForLabel>search_id_normalized</fieldForLabel>
        <fieldForValue>search_id_normalized</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by search_id_normalized</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_type" searchWhenChanged="true">
        <label>Search Type</label>
        <choice value="*">All</choice>
        <choice value="adhoc">Ad-Hoc</choice>
        <choice value="datamodel_acceleration">Datamodel Acceleration</choice>
        <choice value="report_acceleration">Report Acceleration</choice>
        <choice value="scheduled">Scheduled Reports/Alerts</choice>
        <choice value="summary_indexing">Summary Indexing</choice>
        <choice value="typeahead">Typeahead</choice>
        <fieldForLabel>search_type</fieldForLabel>
        <fieldForValue>search_type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="info" searchWhenChanged="true">
        <label>Search Info</label>
        <choice value="*">All</choice>
        <fieldForLabel>info</fieldForLabel>
        <fieldForValue>info</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by info</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="savedsearch_name" searchWhenChanged="true">
        <label>Savedsearch Name</label>
        <choice value="*">All</choice>
        <fieldForLabel>savedsearch_name</fieldForLabel>
        <fieldForValue>savedsearch_name</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by savedsearch_name</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_class" searchWhenChanged="true">
        <label>Search Class</label>
        <choice value="*">All</choice>
        <fieldForLabel>search_class</fieldForLabel>
        <fieldForValue>search_class</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by search_class</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="savedsearch_type" searchWhenChanged="true">
        <label>Savedsearch Type</label>
        <choice value="*">All</choice>
        <choice value="alert">Alert</choice>
        <choice value="report">Report</choice>
        <fieldForLabel>savedsearch_type</fieldForLabel>
        <fieldForValue>savedsearch_type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="user" searchWhenChanged="true">
        <label>User</label>
        <choice value="*">All</choice>
        <fieldForLabel>user</fieldForLabel>
        <fieldForValue>user</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by user</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="LOB" searchWhenChanged="true">
        <label>LOB</label>
        <choice value="*">All</choice>
        <fieldForLabel>LOB</fieldForLabel>
        <fieldForValue>LOB</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by LOB</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Department" searchWhenChanged="true">
        <label>Department</label>
        <choice value="*">All</choice>
        <fieldForLabel>Department</fieldForLabel>
        <fieldForValue>Department</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by Department</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="City" searchWhenChanged="true">
        <label>City</label>
        <choice value="*">All</choice>
        <fieldForLabel>City</fieldForLabel>
        <fieldForValue>City</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by City</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="State" searchWhenChanged="true">
        <label>State</label>
        <choice value="*">All</choice>
        <fieldForLabel>State</fieldForLabel>
        <fieldForValue>State</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by State</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Country" searchWhenChanged="true">
        <label>Country</label>
        <choice value="*">All</choice>
        <fieldForLabel>Country</fieldForLabel>
        <fieldForValue>Country</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by Country</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="datamodel" searchWhenChanged="true">
        <label>Datamodel</label>
        <choice value="*">All</choice>
        <fieldForLabel>datamodel</fieldForLabel>
        <fieldForValue>datamodel</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by datamodel</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="dataset" searchWhenChanged="true">
        <label>Dataset</label>
        <choice value="*">All</choice>
        <fieldForLabel>dataset</fieldForLabel>
        <fieldForValue>dataset</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by dataset</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Lookup_Reference" searchWhenChanged="true">
        <label>Lookup Reference</label>
        <choice value="*">All</choice>
        <fieldForLabel>Lookup_Reference</fieldForLabel>
        <fieldForValue>Lookup_Reference</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by Lookup_Reference</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="host" searchWhenChanged="true">
        <label>Host</label>
        <choice value="*">All</choice>
        <fieldForLabel>host</fieldForLabel>
        <fieldForValue>host</fieldForValue>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| stats count by host</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="searched_buckets" searchWhenChanged="true">
        <label>Number Searched Buckets &gt;</label>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <input type="text" token="search_size" searchWhenChanged="true">
        <label>Search Size</label>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <input type="text" token="search" searchWhenChanged="true">
        <label>Search</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="total_run_time" searchWhenChanged="true">
        <label>Total Run Time in Seconds &gt;</label>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <input type="text" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID (Contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <table>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| eval search_lt = strftime(search_lt,"%m/%d/%Y %H:%M:%S") , search_et = strftime(search_et,"%m/%d/%Y %H:%M:%S") , dispatch_time = strftime(dispatch_time,"%m/%d/%Y %H:%M:%S") , _time = strftime(_time,"%m/%d/%Y %H:%M:%S") , exec_time = strftime(exec_time,"%m/%d/%Y %H:%M:%S") 
| sort 0 - total_run_time 
| `gmc_convert_runtime('total_run_time')` 
| table host Splunk_Role search_id_normalized search_type info savedsearch_name dispatch_time total_run_time 'total_run_time' _time search_et search_lt user Name Worker_Status Worker_Type Department LOB Title Author_Roles City State Country datamodel dataset scan_count event_count result_count available_count considered_events searched_buckets total_slices decompressed_slices search_size search 
| rename _time as "Completion Time (_time)" , host as Host , search_id as "Search ID" , search_id_normalized as "Normalized Search ID" , user as User , search_type as "Search Type" , savedsearch_name as "Savedsearch Name" , datamodel as Datamodel , dataset as Dataset , 'total_run_time' as Runtime, total_run_time as Runtime_Sec , scan_count as "Scan Count" , search_et AS "Search ET" , search_lt as "Search LT" , dispatch_time as "Dispatch Time" , info as Info , event_count as "Event Count" , result_count as "Result Count" , available_count as "Available Count" , considered_events as "Considered Events" , searched_buckets as "Searched Buckets" , total_slices as "Total Slices" , decompressed_slices as "Decompressed Slices" , search_startup_time as "Search Startup Time" , search_size as "Search Size" , search as Search , exec_time as "Execution Time"</query>
        </search>
        <option name="count">5</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format type="color" field="Host">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Savedsearch Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Normalized Search ID">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Info">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="User">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Worker_Status">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Department">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Worker_Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Title">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="LOB">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="City">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="State">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Country">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Datamodel">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Dataset">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Scan Count">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Event Count"></format>
        <format type="number" field="Result Count">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Considered Events">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Available Count">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Total Slices">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Decompressed Slices">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Search">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Runtime_Sec">
          <colorPalette type="list">[#53A051,#006D9C,#F8BE34,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">0,300,600,900</scale>
        </format>
        <format type="number" field="Runtime_Sec">
          <option name="unit">s</option>
        </format>
        <format type="number" field="Searched Buckets">
          <option name="precision">0</option>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Search Code</title>
      <table>
        <search base="Splunk_Monitoring_Audit_Search">
          <query>| eval search_org=search 
| rex field=search mode=sed "s/^search\s//g"
| rex field=search mode=sed "s/\n//g"
| rex field=search mode=sed "s/^\s|^\"//g" 
| rex field=search mode=sed "s/\s{2,}/ /g" 
| rex field=search mode=sed "s/\n//g"
| rex field=search mode=sed "s/\|/\n|/g"
| rex field=search mode=sed "s/\|\s*/| /g" 
| stats count by search 
| rename search as Search
| where Search!="Undefined"</query>
        </search>
        <option name="count">1</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">none</option>
        <option name="wrap">false</option>
        <format type="color" field="Search">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Internal Scheduler Usage</title>
      <input type="time" token="TimeRangePkr3" searchWhenChanged="true">
        <label>Internal Time Range</label>
        <default>
          <earliest>-15m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <input type="dropdown" token="Splunk_Role" searchWhenChanged="true">
        <label>Splunk Role</label>
        <choice value="*">All</choice>
        <fieldForLabel>Splunk_Role</fieldForLabel>
        <fieldForValue>Splunk_Role</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by Splunk_Role</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID</label>
        <choice value="*">All</choice>
        <fieldForLabel>search_id_normalized</fieldForLabel>
        <fieldForValue>search_id_normalized</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by search_id_normalized</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="search_type" searchWhenChanged="true">
        <label>Search Type</label>
        <choice value="*">All</choice>
        <choice value="datamodel_acceleration">datamodel_acceleration</choice>
        <choice value="report_acceleration">report_acceleration</choice>
        <choice value="scheduled">scheduled</choice>
        <choice value="summary_indexing">summary_indexing</choice>
        <fieldForLabel>search_type</fieldForLabel>
        <fieldForValue>search_type</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="info" searchWhenChanged="true">
        <label>Search Info</label>
        <choice value="*">All</choice>
        <choice value="completed">completed</choice>
        <choice value="deferred">deferred</choice>
        <choice value="delegated_remote">delegated_remote</choice>
        <choice value="delegated_remote_completion">delegated_remote_completion</choice>
        <choice value="delegated_remote_error">delegated_remote_error</choice>
        <choice value="skipped">skipped</choice>
        <fieldForLabel>info</fieldForLabel>
        <fieldForValue>info</fieldForValue>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="savedsearch_name" searchWhenChanged="true">
        <label>Savedsearch Name</label>
        <choice value="*">All</choice>
        <fieldForLabel>savedsearch_name</fieldForLabel>
        <fieldForValue>savedsearch_name</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by savedsearch_name</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="LOB" searchWhenChanged="true">
        <label>LOB</label>
        <choice value="*">All</choice>
        <fieldForLabel>LOB</fieldForLabel>
        <fieldForValue>LOB</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by LOB</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Department" searchWhenChanged="true">
        <label>Department</label>
        <choice value="*">All</choice>
        <fieldForLabel>Department</fieldForLabel>
        <fieldForValue>Department</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by Department</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="City" searchWhenChanged="true">
        <label>City</label>
        <choice value="*">All</choice>
        <fieldForLabel>City</fieldForLabel>
        <fieldForValue>City</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by City</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="State" searchWhenChanged="true">
        <label>State</label>
        <choice value="*">All</choice>
        <fieldForLabel>State</fieldForLabel>
        <fieldForValue>State</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by State</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="Country" searchWhenChanged="true">
        <label>Country</label>
        <choice value="*">All</choice>
        <fieldForLabel>Country</fieldForLabel>
        <fieldForValue>Country</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by Country</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="host" searchWhenChanged="true">
        <label>Host</label>
        <choice value="*">All</choice>
        <fieldForLabel>host</fieldForLabel>
        <fieldForValue>host</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by host</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="app" searchWhenChanged="true">
        <label>App</label>
        <choice value="*">All</choice>
        <fieldForLabel>app</fieldForLabel>
        <fieldForValue>app</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by app</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="user" searchWhenChanged="true">
        <label>User</label>
        <choice value="*">All</choice>
        <fieldForLabel>user</fieldForLabel>
        <fieldForValue>user</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by user</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="priority" searchWhenChanged="true">
        <label>Schedule Priority</label>
        <choice value="*">All</choice>
        <fieldForLabel>priority</fieldForLabel>
        <fieldForValue>priority</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by priority</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="window_time" searchWhenChanged="true">
        <label>Schedule Window</label>
        <choice value="*">All</choice>
        <fieldForLabel>window_time</fieldForLabel>
        <fieldForValue>window_time</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by window_time</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="concurrency_category" searchWhenChanged="true">
        <label>Concurrency Category</label>
        <choice value="*">All</choice>
        <fieldForLabel>concurrency_category</fieldForLabel>
        <fieldForValue>concurrency_category</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by concurrency_category</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="concurrency_context" searchWhenChanged="true">
        <label>Concurrency Context</label>
        <choice value="*">All</choice>
        <fieldForLabel>concurrency_context</fieldForLabel>
        <fieldForValue>concurrency_context</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by concurrency_context</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="concurrency_limit" searchWhenChanged="true">
        <label>Concurrency Limit</label>
        <choice value="*">All</choice>
        <fieldForLabel>concurrency_limit</fieldForLabel>
        <fieldForValue>concurrency_limit</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by concurrency_limit</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="dropdown" token="reason" searchWhenChanged="true">
        <label>Skip Reason</label>
        <choice value="*">All</choice>
        <fieldForLabel>reason</fieldForLabel>
        <fieldForValue>reason</fieldForValue>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| stats count by reason</query>
        </search>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="search_id_normalized" searchWhenChanged="true">
        <label>Normalized Search ID (Contains)</label>
        <default>*</default>
        <initialValue>*</initialValue>
      </input>
      <input type="text" token="total_run_time" searchWhenChanged="true">
        <label>Total Run Time in Seconds &gt;</label>
        <default>-1</default>
        <initialValue>-1</initialValue>
      </input>
      <table>
        <search base="Splunk_Monitoring_Internal_Scheduler">
          <query>| eval scheduled_time = strftime(scheduled_time,"%m/%d/%Y %H:%M:%S") , dispatch_time = strftime(dispatch_time,"%m/%d/%Y %H:%M:%S") , _time = strftime(_time,"%m/%d/%Y %H:%M:%S") 
| `gmc_convert_runtime('total_run_time')` 
| table host Splunk_Role search_id_normalized search_type info savedsearch_name _time scheduled_time dispatch_time total_run_time 'total_run_time' app user Name Worker_Status Worker_Type Department LOB Title Author_Roles City State Country datamodel dataset priority window_time result_count concurrency_category concurrency_context concurrency_limit skipped_count reason alert_actions 
| rename priority AS "Schedule Priority" , window_time AS "Schedule Window" , _time as "Search Time" , host as Host , search_id as "Search ID" , search_id_normalized as "Normalized Search ID" , user as User , search_type as "Search Type" , savedsearch_name as "Savedsearch Name" , datamodel as Datamodel , dataset as Dataset , dispatch_time as "Dispatch Time" , info as Info , result_count as "Result Count" , app as App , concurrency_category as "Concurrency Category" , concurrency_context as "Concurrency Context" , concurrency_limit as "Concurrency Limit" , skipped_count as "Skipped Count" , reason as Reason , alert_actions as "Alert Actions" , 'total_run_time' as Runtime, total_run_time AS Runtime_Sec</query>
        </search>
        <option name="count">5</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">none</option>
        <option name="rowNumbers">true</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format type="color" field="Host">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Savedsearch Name">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Normalized Search ID">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Info">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Runtime_Sec">
          <colorPalette type="list">[#53A051,#006D9C,#F8BE34,#F1813F,#DC4E41]</colorPalette>
          <scale type="threshold">0,300,600,900</scale>
        </format>
        <format type="number" field="Runtime_Sec">
          <option name="unit">s</option>
        </format>
        <format type="color" field="App">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="User">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Search Type">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Schedule Priority">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Schedule Window">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Result Count">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Concurrency Category">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Concurrency Context">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="Concurrency Limit">
          <option name="precision">0</option>
        </format>
        <format type="number" field="Skipped Count">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Reason">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="Alert Actions">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
</form>